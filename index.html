<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PRIME360.AI - –ì–ª–∞–≤–Ω–∞—è (Deploy Test)</title>
    <link rel="icon" type="image/png" href="img/icon prime360.png">
    <link rel="apple-touch-icon" href="img/icon prime360.png">
    <link rel="stylesheet" href="css/index.css">
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Data Manager -->
    <script src="js/data-manager.js"></script>
    <!-- User Profile Script -->
    <script src="js/user-profile.js"></script>
    <!-- Mobile Responsive -->
    <link rel="stylesheet" href="css/mobile-responsive.css">
    <script src="js/mobile-menu.js"></script>
</head>
<body>
    <div class="mobile-overlay" id="mobileOverlay"></div>
    
    <div class="container">
        <div class="sidebar" id="sidebar">
            <div class="logo">
                <div class="logo-icon">
                    <img src="img/icon prime360.png" alt="PRIME360.AI" width="32" height="32">
                </div>
                <div class="logo-text">PRIME360.AI</div>
            </div>
            
            <a href="index.html" class="menu-item active">
                <span class="menu-icon">üè†</span>
                –ì–ª–∞–≤–Ω–æ–µ
            </a>
            <a href="projects.html" class="menu-item">
                <span class="menu-icon">üìä</span>
                –ü—Ä–æ–µ–∫—Ç—ã
            </a>
            <a href="#" class="menu-item" onclick="toggleAIChat(); return false;">
                <span class="menu-icon">ü§ñ</span>
                AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç
            </a>
            <a href="documents.html" class="menu-item">
                <span class="menu-icon">üìö</span>
                –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞
            </a>
            <a href="meetings.html" class="menu-item">
                <span class="menu-icon">üí¨</span>
                –°–æ–≤–µ—â–∞–Ω–∏—è
            </a>
            <a href="messenger.html" class="menu-item">
                <span class="menu-icon">üì±</span>
                –ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä
            </a>

        </div>

        <div class="main-content">
            <div class="header">
                <div></div>
                <div class="search-container">
                    <input type="text" id="global-search" class="search-input" placeholder="–ü–æ–∏—Å–∫">
                    <span class="search-icon">üîç</span>
                </div>
                <div class="user-profile">
                    <div class="user-info">
                        <div class="user-name" id="userName">–ê–π–≥—É–Ω –ê—Ö–º–µ—Ç–æ–≤–∞</div>
                        <div class="user-role" id="userRole">–ê–¥–º–∏–Ω</div>
                    </div>
                    <div class="user-avatar" id="userAvatar">–ê–ê</div>
                    <button onclick="logout()" class="logout-button">–í—ã–π—Ç–∏</button>
                </div>
            </div>

            <!-- Main Page Content -->
            <div class="content-header">
                <div class="content-title">
                    <div class="title-left">
                        <div class="title-text">–ì–ª–∞–≤–Ω–∞—è</div>
                    </div>
                </div>
                <!-- –í—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ
                <div class="filters">
                    <button class="filter-button" id="dateFilterBtn" onclick="openDateFilter()">
                        <span>üìÖ</span>
                        <span id="selectedDate">–°–µ–≥–æ–¥–Ω—è</span>
                    </button>
                    <button class="filter-button" id="projectFilterBtn" onclick="openProjectsFilter()">
                        <span>üìä</span>
                        <span id="selectedProject">–í—Å–µ –ø—Ä–æ–µ–∫—Ç—ã</span>
                    </button>
                    <button class="filter-button" id="advancedFilterBtn" onclick="openAdvancedFilters()">
                        <span>üîç</span>
                        –§–∏–ª—å—Ç—Ä—ã
                        <span class="filter-badge" id="filterBadge" style="display: none;">0</span>
                    </button>
                </div>
                -->
                
                <!-- Active Filters Display -->
                <!-- –í—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ
                <div class="active-filters" id="activeFilters" style="display: none;">
                    <div class="active-filters-header">
                        <span class="active-filters-title">–ê–∫—Ç–∏–≤–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã:</span>
                        <button class="clear-all-filters" onclick="clearAllFilters()">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ</button>
                    </div>
                    <div class="active-filters-list" id="activeFiltersList">
                        –ê–∫—Ç–∏–≤–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –∑–¥–µ—Å—å
                    </div>
                </div>
                -->
            </div>

            <div class="content-body">
                <!-- Quick Actions Banner -->
                <div class="quick-actions-banner">
                    <div class="banner-content">
                        <div class="banner-icon">üöÄ</div>
                        <div class="banner-text">
                            <h4>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ PRIME360.AI</h4>
                            <p>–£–ø—Ä–∞–≤–ª—è–π—Ç–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Å –ø–æ–º–æ—â—å—é AI</p>
                        </div>
                    </div>
                    <div class="banner-buttons">
                        <button class="action-btn primary" onclick="createNewProject()">
                            <span class="btn-icon">‚ûï</span>
                            –ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
                        </button>
                        <button class="action-btn secondary" onclick="openAnalyticsPresentation()">
                            <span class="btn-icon">üìä</span>
                            –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö
                        </button>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card clickable" onclick="openProjectsTasksModal()">
                        <div class="stat-header">
                            <span class="stat-icon">üìã</span>
                            <h3>–ê–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã</h3>
                        </div>
                        <div class="stat-value">4</div>
                        <div class="stat-description">+2 –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü</div>
                        <div class="stat-progress">
                            <div class="progress-bar" style="width: 75%;"></div>
                        </div>
                        <button class="card-action-btn">–ü–æ–¥—Ä–æ–±–Ω–µ–µ ‚Üí</button>
                    </div>
                    
                    <div class="stat-card green clickable" onclick="navigateTo('meetings.html')">
                        <div class="stat-header">
                            <span class="stat-icon">üí¨</span>
                            <h3>–°–æ–≤–µ—â–∞–Ω–∏—è</h3>
                        </div>
                        <div class="stat-value">12</div>
                        <div class="stat-description">3 —Å–µ–≥–æ–¥–Ω—è</div>
                        <div class="stat-progress">
                            <div class="progress-bar green" style="width: 60%;"></div>
                        </div>
                        <button class="card-action-btn">–ü–æ–¥—Ä–æ–±–Ω–µ–µ ‚Üí</button>
                    </div>
                    
                    <div class="stat-card orange clickable" onclick="navigateTo('finances.html')">
                        <div class="stat-header">
                            <span class="stat-icon">üí∞</span>
                            <h3>–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π —É—á–µ—Ç</h3>
                        </div>
                        <div class="stat-value">‚Ç∏2.4M</div>
                        <div class="stat-description">–û–±—â–∏–π –±—é–¥–∂–µ—Ç</div>
                        <div class="stat-progress">
                            <div class="progress-bar orange" style="width: 85%;"></div>
                        </div>
                        <button class="card-action-btn">–ü–æ–¥—Ä–æ–±–Ω–µ–µ ‚Üí</button>
                    </div>
                </div>

                <div class="activity-section">
                    <div class="section-header">
                    <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</h3>
                        <button class="view-all-btn" onclick="viewAllActivities()">–°–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ ‚Üí</button>
                    </div>
                    <div class="activity-list" id="activitiesList">
                        <!-- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∏–∑ DataManager -->
                    </div>
                </div>

                <div class="chart-section">
                    <div class="chart-header">
                    <div>
                            <h3>–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤</h3>
                            <p class="chart-subtitle" id="chartSubtitle">–î–∏–Ω–∞–º–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤</p>
                            </div>
                        <div class="chart-controls">
                            <button class="chart-filter-btn active" data-period="6m">6 –º–µ—Å</button>
                            <button class="chart-filter-btn" data-period="3m">3 –º–µ—Å</button>
                            <button class="chart-filter-btn" data-period="1m">1 –º–µ—Å</button>
                        </div>
                    </div>
                    <div class="chart-stats">
                        <div class="chart-stat-item">
                            <div class="chart-stat-label">–í—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–æ–≤</div>
                            <div class="chart-stat-value">4</div>
                        </div>
                        <div class="chart-stat-item">
                            <div class="chart-stat-label">–°—Ä–µ–¥–Ω–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å</div>
                            <div class="chart-stat-value">76%</div>
                        </div>
                        <div class="chart-stat-item">
                            <div class="chart-stat-label">–í —Å—Ä–æ–∫</div>
                            <div class="chart-stat-value green">3</div>
                        </div>
                        <div class="chart-stat-item">
                            <div class="chart-stat-label">–° –∑–∞–¥–µ—Ä–∂–∫–æ–π</div>
                            <div class="chart-stat-value orange">1</div>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="progressChart"></canvas>
                    </div>
                    <div class="chart-legend-custom">
                        <div class="legend-item" data-dataset="0" onclick="toggleDataset(0)">
                            <div class="legend-color" style="background: linear-gradient(135deg, #70B8B8, #5A9A9A);"></div>
                            <div class="legend-info">
                                <div class="legend-name">–ñ–ö –ü—Ä–æ–≥—Ä–µ—Å—Å</div>
                                <div class="legend-status">85% –∑–∞–≤–µ—Ä—à–µ–Ω–æ</div>
                            </div>
                            <div class="legend-toggle">üëÅÔ∏è</div>
                        </div>
                        <div class="legend-item" data-dataset="1" onclick="toggleDataset(1)">
                            <div class="legend-color" style="background: linear-gradient(135deg, #10b981, #059669);"></div>
                            <div class="legend-info">
                                <div class="legend-name">–ê—Å—Ç–∞–Ω–∞ Plaza</div>
                                <div class="legend-status">80% –∑–∞–≤–µ—Ä—à–µ–Ω–æ</div>
                            </div>
                            <div class="legend-toggle">üëÅÔ∏è</div>
                        </div>
                        <div class="legend-item" data-dataset="2" onclick="toggleDataset(2)">
                            <div class="legend-color" style="background: linear-gradient(135deg, #f59e0b, #d97706);"></div>
                            <div class="legend-info">
                                <div class="legend-name">–ö–ª–∏–µ–Ω—Ç –ê</div>
                                <div class="legend-status">65% –∑–∞–≤–µ—Ä—à–µ–Ω–æ</div>
                            </div>
                            <div class="legend-toggle">üëÅÔ∏è</div>
                        </div>
                        <div class="legend-item" data-dataset="3" onclick="toggleDataset(3)">
                            <div class="legend-color" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);"></div>
                            <div class="legend-info">
                                <div class="legend-name">–ö–ª–∏–µ–Ω—Ç –ë</div>
                                <div class="legend-status">72% –∑–∞–≤–µ—Ä—à–µ–Ω–æ</div>
                            </div>
                            <div class="legend-toggle">üëÅÔ∏è</div>
                        </div>
                    </div>
                </div>
            </div>
                            </div>
                        </div>
                        
    <!-- Floating AI Assistant Button -->
    <button class="ai-float-button" onclick="toggleAIChat()" title="AI –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç">
        <span class="ai-float-icon">ü§ñ</span>
        <span class="ai-pulse"></span>
    </button>

    <!-- AI Chat Window -->
    <div id="aiChatWindow" class="ai-chat-window">
        <div class="ai-chat-header">
            <div class="ai-chat-title">
                <span class="ai-chat-icon">ü§ñ</span>
                <div>
                    <div class="ai-chat-name">AI –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç PRIME360</div>
                    <div class="ai-chat-status">
                        <span class="status-dot online"></span>
                        –í —Å–µ—Ç–∏
                            </div>
                </div>
            </div>
            <div class="ai-chat-actions">
                <button class="ai-action-btn" onclick="minimizeAIChat()" title="–°–≤–µ—Ä–Ω—É—Ç—å">‚àí</button>
                <button class="ai-action-btn" onclick="closeAIChat()" title="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
                            </div>
                        </div>
                        
        <div class="ai-chat-body" id="aiChatBody">
            <div class="ai-welcome-message">
                <div class="ai-avatar">ü§ñ</div>
                <div class="ai-message">
                    <div class="ai-message-text">
                        –ü—Ä–∏–≤–µ—Ç! –Ø AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç PRIME360. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?
                        <div class="ai-suggestions">
                            <button class="suggestion-btn" onclick="sendSuggestion('–ü–æ–∫–∞–∑–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏')">
                                üìã –ü–æ–∫–∞–∑–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏
                            </button>
                            <button class="suggestion-btn" onclick="sendSuggestion('–°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–æ–≤')">
                                üìä –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–æ–≤
                            </button>
                            <button class="suggestion-btn" onclick="sendSuggestion('–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á–µ—Ç')">
                                üí∞ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á–µ—Ç
                            </button>
                            </div>
                    </div>
                </div>
                            </div>
                        </div>

        <div class="ai-chat-footer">
            <div class="ai-input-container">
                <button class="ai-attach-btn" title="–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª">üìé</button>
                <input type="text" 
                       id="aiChatInput" 
                       class="ai-input" 
                       placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." 
                       onkeypress="handleAIEnter(event)">
                <button class="ai-send-btn" onclick="sendAIMessage()" title="–û—Ç–ø—Ä–∞–≤–∏—Ç—å">
                    <span class="send-icon">üì§</span>
                </button>
                            </div>
            <div class="ai-footer-info">
                <span class="ai-footer-text">AI –º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å –æ—à–∏–±–∫–∏. –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –≤–∞–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.</span>
            </div>
                            </div>
                        </div>

    <!-- Modal for Date Filter -->
    <div id="dateFilterModal" class="modal">
        <div class="modal-content filter-modal-content">
            <div class="modal-header">
                <h2>
                    <span class="modal-icon">üìÖ</span>
                    –í—ã–±—Ä–∞—Ç—å –ø–µ—Ä–∏–æ–¥
                </h2>
                <button class="close-modal" onclick="closeDateFilterModal()">&times;</button>
                            </div>
            <div class="modal-body filter-modal-body">
                <div class="filter-options">
                    <button class="filter-option-btn active" data-date="today" onclick="selectDateFilter('today', '–°–µ–≥–æ–¥–Ω—è')">
                        <span class="option-icon">üìÖ</span>
                        <span class="option-text">–°–µ–≥–æ–¥–Ω—è</span>
                        <span class="option-check">‚úì</span>
                    </button>
                    <button class="filter-option-btn" data-date="yesterday" onclick="selectDateFilter('yesterday', '–í—á–µ—Ä–∞')">
                        <span class="option-icon">üìÖ</span>
                        <span class="option-text">–í—á–µ—Ä–∞</span>
                        <span class="option-check">‚úì</span>
                    </button>
                    <button class="filter-option-btn" data-date="week" onclick="selectDateFilter('week', '–≠—Ç–∞ –Ω–µ–¥–µ–ª—è')">
                        <span class="option-icon">üìÖ</span>
                        <span class="option-text">–≠—Ç–∞ –Ω–µ–¥–µ–ª—è</span>
                        <span class="option-check">‚úì</span>
                    </button>
                    <button class="filter-option-btn" data-date="month" onclick="selectDateFilter('month', '–≠—Ç–æ—Ç –º–µ—Å—è—Ü')">
                        <span class="option-icon">üìÖ</span>
                        <span class="option-text">–≠—Ç–æ—Ç –º–µ—Å—è—Ü</span>
                        <span class="option-check">‚úì</span>
                    </button>
                    <button class="filter-option-btn" data-date="custom" onclick="selectDateFilter('custom', '–ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥')">
                        <span class="option-icon">üìÖ</span>
                        <span class="option-text">–ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥</span>
                        <span class="option-check">‚úì</span>
                    </button>
                            </div>
                        </div>
                    </div>
                </div>

    <!-- Modal for Projects Filter -->
    <div id="projectsFilterModal" class="modal">
        <div class="modal-content filter-modal-content">
            <div class="modal-header">
                <h2>
                    <span class="modal-icon">üìä</span>
                    –í—ã–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
                </h2>
                <button class="close-modal" onclick="closeProjectsFilterModal()">&times;</button>
                    </div>
            <div class="modal-body filter-modal-body">
                <div class="filter-options">
                    <button class="filter-option-btn active" data-project="all" onclick="selectProjectFilter('all', '–í—Å–µ –ø—Ä–æ–µ–∫—Ç—ã')">
                        <span class="option-icon">üìä</span>
                        <span class="option-text">–í—Å–µ –ø—Ä–æ–µ–∫—Ç—ã</span>
                        <span class="option-check">‚úì</span>
                    </button>
                    <button class="filter-option-btn" data-project="progress" onclick="selectProjectFilter('progress', '–ñ–ö –ü—Ä–æ–≥—Ä–µ—Å—Å')">
                        <span class="option-icon" style="color: #70B8B8;">‚óè</span>
                        <span class="option-text">–ñ–ö –ü—Ä–æ–≥—Ä–µ—Å—Å</span>
                        <span class="option-check">‚úì</span>
                    </button>
                    <button class="filter-option-btn" data-project="plaza" onclick="selectProjectFilter('plaza', '–ê—Å—Ç–∞–Ω–∞ Plaza')">
                        <span class="option-icon" style="color: #10b981;">‚óè</span>
                        <span class="option-text">–ê—Å—Ç–∞–Ω–∞ Plaza</span>
                        <span class="option-check">‚úì</span>
                    </button>
                    <button class="filter-option-btn" data-project="client-a" onclick="selectProjectFilter('client-a', '–ö–ª–∏–µ–Ω—Ç –ê')">
                        <span class="option-icon" style="color: #f59e0b;">‚óè</span>
                        <span class="option-text">–ö–ª–∏–µ–Ω—Ç –ê</span>
                        <span class="option-check">‚úì</span>
                    </button>
                    <button class="filter-option-btn" data-project="client-b" onclick="selectProjectFilter('client-b', '–ö–ª–∏–µ–Ω—Ç –ë')">
                        <span class="option-icon" style="color: #8b5cf6;">‚óè</span>
                        <span class="option-text">–ö–ª–∏–µ–Ω—Ç –ë</span>
                        <span class="option-check">‚úì</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for Advanced Filters -->
    <div id="advancedFiltersModal" class="modal">
        <div class="modal-content advanced-filter-modal-content">
            <div class="modal-header">
                <h2>
                    <span class="modal-icon">üîç</span>
                    –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã
                </h2>
                <button class="close-modal" onclick="closeAdvancedFiltersModal()">&times;</button>
            </div>
            <div class="modal-body advanced-filter-body">
                <div class="filter-section">
                    <h3 class="filter-section-title">–°—Ç–∞—Ç—É—Å</h3>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" checked>
                            <span>–ê–∫—Ç–∏–≤–Ω—ã–µ</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" checked>
                            <span>–í –ø—Ä–æ—Ü–µ—Å—Å–µ</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox">
                            <span>–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox">
                            <span>–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ</span>
                        </label>
                    </div>
                </div>

                <div class="filter-section">
                    <h3 class="filter-section-title">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</h3>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" checked>
                            <span class="priority-label high">–í—ã—Å–æ–∫–∏–π</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" checked>
                            <span class="priority-label medium">–°—Ä–µ–¥–Ω–∏–π</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" checked>
                            <span class="priority-label low">–ù–∏–∑–∫–∏–π</span>
                        </label>
                    </div>
                </div>

                <div class="filter-section">
                    <h3 class="filter-section-title">–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π</h3>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" checked>
                            <span>–ê–π–≥—É–Ω –ê—Ö–º–µ—Ç–æ–≤–∞</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" checked>
                            <span>–ò–Ω–∂–µ–Ω–µ—Ä –ü–µ—Ç—Ä–æ–≤</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" checked>
                            <span>–í—Å–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</span>
                        </label>
                    </div>
                </div>

                <div class="filter-section">
                    <h3 class="filter-section-title">–ü—Ä–æ–≥—Ä–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</h3>
                    <div class="range-slider">
                        <input type="range" min="0" max="100" value="0" id="progressRangeMin" oninput="updateProgressRange()">
                        <input type="range" min="0" max="100" value="100" id="progressRangeMax" oninput="updateProgressRange()">
                        <div class="range-values">
                            <span id="progressMin">0%</span> - <span id="progressMax">100%</span>
                        </div>
                    </div>
                </div>

                <div class="filter-section">
                    <h3 class="filter-section-title">–¢–µ–≥–∏</h3>
                    <div class="tag-filters">
                        <button class="tag-filter-btn">–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</button>
                        <button class="tag-filter-btn">–°—Ä–æ—á–Ω–æ</button>
                        <button class="tag-filter-btn">–ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞</button>
                        <button class="tag-filter-btn">–§–∏–Ω–∞–Ω—Å—ã</button>
                        <button class="tag-filter-btn">–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</button>
                        <button class="tag-filter-btn">–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" onclick="resetAdvancedFilters()">
                    –°–±—Ä–æ—Å–∏—Ç—å
                </button>
                <button type="button" class="btn-primary" onclick="applyAdvancedFilters()">
                    <span class="btn-icon">‚úì</span>
                    –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
                </button>
            </div>
        </div>
    </div>

    <!-- Modal for Active Projects Tasks -->
    <div id="projectsTasksModal" class="modal">
        <div class="modal-content tasks-modal-content">
            <div class="modal-header">
                <h2>
                    <span class="modal-icon">üìã</span>
                    –í—Å–µ –∑–∞–¥–∞—á–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
                </h2>
                <button class="close-modal" onclick="closeProjectsTasksModal()">&times;</button>
            </div>
            <div class="tasks-filters">
                <button class="task-filter-btn active" data-filter="all">
                    –í—Å–µ –∑–∞–¥–∞—á–∏ <span class="filter-count" id="countAll">28</span>
                </button>
                <button class="task-filter-btn" data-filter="urgent">
                    –°—Ä–æ—á–Ω—ã–µ <span class="filter-count urgent" id="countUrgent">5</span>
                </button>
                <button class="task-filter-btn" data-filter="today">
                    –°–µ–≥–æ–¥–Ω—è <span class="filter-count today" id="countToday">8</span>
                </button>
                <button class="task-filter-btn" data-filter="overdue">
                    –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ <span class="filter-count overdue" id="countOverdue">3</span>
                </button>
            </div>
            <div class="modal-body tasks-modal-body" id="tasksModalBody">
                <!-- Tasks will be dynamically inserted here -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" onclick="closeProjectsTasksModal()">
                    –ó–∞–∫—Ä—ã—Ç—å
                </button>
                <button type="button" class="btn-primary" onclick="navigateTo('projects.html')">
                    <span class="btn-icon">‚Üí</span>
                    –û—Ç–∫—Ä—ã—Ç—å –≤—Å–µ –∑–∞–¥–∞—á–∏
                </button>
            </div>
        </div>
    </div>

    <!-- Modal for Activity Details -->
    <div id="activityModal" class="modal">
        <div class="modal-content activity-modal-content">
            <div class="modal-header">
                <h2 id="activityModalTitle">
                    <span class="modal-icon" id="activityModalIcon">üìù</span>
                    <span id="activityModalTitleText">–î–µ—Ç–∞–ª–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</span>
                </h2>
                <button class="close-modal" onclick="closeActivityModal()">&times;</button>
            </div>
            <div class="modal-body" id="activityModalBody">
                <!-- Dynamic content will be inserted here -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" onclick="closeActivityModal()">
                    –ó–∞–∫—Ä—ã—Ç—å
                </button>
                <button type="button" class="btn-primary" id="activityActionBtn">
                    <span class="btn-icon">‚Üí</span>
                    <span id="activityActionText">–ü–µ—Ä–µ–π—Ç–∏</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Modal for New Project -->
    <div id="newProjectModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>
                    <span class="modal-icon">üöÄ</span>
                    –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
                </h2>
                <button class="close-modal" onclick="closeNewProjectModal()">&times;</button>
            </div>
            <form id="newProjectForm" class="modal-body">
                <div class="form-group">
                    <label for="projectName">
                        <span class="label-icon">üìù</span>
                        –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ *
                    </label>
                    <input type="text" id="projectName" name="projectName" required 
                           placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ñ–ö –ü—Ä–æ–≥—Ä–µ—Å—Å">
                </div>

                <div class="form-group">
                    <label for="projectDescription">
                        <span class="label-icon">üìÑ</span>
                        –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
                    </label>
                    <textarea id="projectDescription" name="projectDescription" rows="4"
                              placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞..."></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="projectBudget">
                            <span class="label-icon">üí∞</span>
                            –ë—é–¥–∂–µ—Ç (‚Ç∏)
                        </label>
                        <input type="number" id="projectBudget" name="projectBudget" 
                               placeholder="5000000">
                    </div>

                    <div class="form-group">
                        <label for="projectStatus">
                            <span class="label-icon">üìä</span>
                            –°—Ç–∞—Ç—É—Å
                        </label>
                        <select id="projectStatus" name="projectStatus">
                            <option value="planning">–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</option>
                            <option value="active" selected>–ê–∫—Ç–∏–≤–Ω—ã–π</option>
                            <option value="on-hold">–ù–∞ –ø–∞—É–∑–µ</option>
                            <option value="completed">–ó–∞–≤–µ—Ä—à–µ–Ω</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="projectStartDate">
                            <span class="label-icon">üìÖ</span>
                            –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞
                        </label>
                        <input type="date" id="projectStartDate" name="projectStartDate">
                    </div>

                    <div class="form-group">
                        <label for="projectEndDate">
                            <span class="label-icon">üèÅ</span>
                            –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è
                        </label>
                        <input type="date" id="projectEndDate" name="projectEndDate">
                    </div>
                </div>

                <div class="form-group">
                    <label for="projectManager">
                        <span class="label-icon">üë§</span>
                        –ú–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–æ–µ–∫—Ç–∞
                    </label>
                    <select id="projectManager" name="projectManager">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –º–µ–Ω–µ–¥–∂–µ—Ä–∞</option>
                        <option value="aigul">–ê–π–≥—É–Ω –ê—Ö–º–µ—Ç–æ–≤–∞</option>
                        <option value="manager2">–ú–µ–Ω–µ–¥–∂–µ—Ä 2</option>
                        <option value="manager3">–ú–µ–Ω–µ–¥–∂–µ—Ä 3</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="projectPriority">
                        <span class="label-icon">‚≠ê</span>
                        –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç
                    </label>
                    <div class="priority-buttons">
                        <button type="button" class="priority-btn" data-priority="low">
                            <span class="priority-dot low"></span>
                            –ù–∏–∑–∫–∏–π
                        </button>
                        <button type="button" class="priority-btn active" data-priority="medium">
                            <span class="priority-dot medium"></span>
                            –°—Ä–µ–¥–Ω–∏–π
                        </button>
                        <button type="button" class="priority-btn" data-priority="high">
                            <span class="priority-dot high"></span>
                            –í—ã—Å–æ–∫–∏–π
                        </button>
                    </div>
                    <input type="hidden" id="projectPriority" name="projectPriority" value="medium">
                </div>

                <div class="form-group">
                    <label>
                        <span class="label-icon">üè∑Ô∏è</span>
                        –¢–µ–≥–∏
                    </label>
                    <div class="tags-input">
                        <input type="text" id="tagInput" placeholder="–î–æ–±–∞–≤—å—Ç–µ —Ç–µ–≥–∏ –∏ –Ω–∞–∂–º–∏—Ç–µ Enter">
                        <div id="tagsContainer" class="tags-container"></div>
                    </div>
                </div>
            </form>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" onclick="closeNewProjectModal()">
                    –û—Ç–º–µ–Ω–∞
                </button>
                <button type="submit" form="newProjectForm" class="btn-primary">
                    <span class="btn-icon">‚úì</span>
                    –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
                </button>
            </div>
        </div>
    </div>

    <script>
        // Navigation functions
        function navigateTo(page) {
            window.location.href = page;
        }

        // Modal functions
        function createNewProject() {
            document.getElementById('newProjectModal').style.display = 'flex';
            setTimeout(() => {
                document.querySelector('#newProjectModal .modal-content').classList.add('show');
            }, 10);
        }

        function closeNewProjectModal() {
            document.querySelector('#newProjectModal .modal-content').classList.remove('show');
            setTimeout(() => {
                document.getElementById('newProjectModal').style.display = 'none';
                document.getElementById('newProjectForm').reset();
                document.getElementById('tagsContainer').innerHTML = '';
                projectTags = [];
            }, 300);
        }

        // Close modal on outside click
        window.onclick = function(event) {
            const projectModal = document.getElementById('newProjectModal');
            const activityModal = document.getElementById('activityModal');
            const tasksModal = document.getElementById('projectsTasksModal');
            const dateFilterModal = document.getElementById('dateFilterModal');
            const projectsFilterModal = document.getElementById('projectsFilterModal');
            const advancedFiltersModal = document.getElementById('advancedFiltersModal');
            
            if (event.target === projectModal) {
                closeNewProjectModal();
            }
            if (event.target === activityModal) {
                closeActivityModal();
            }
            if (event.target === tasksModal) {
                closeProjectsTasksModal();
            }
            if (event.target === dateFilterModal) {
                closeDateFilterModal();
            }
            if (event.target === projectsFilterModal) {
                closeProjectsFilterModal();
            }
            if (event.target === advancedFiltersModal) {
                closeAdvancedFiltersModal();
            }
        }

        // Close modal on Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const projectModal = document.getElementById('newProjectModal');
                const activityModal = document.getElementById('activityModal');
                const tasksModal = document.getElementById('projectsTasksModal');
                const dateFilterModal = document.getElementById('dateFilterModal');
                const projectsFilterModal = document.getElementById('projectsFilterModal');
                const advancedFiltersModal = document.getElementById('advancedFiltersModal');
                
                if (projectModal.style.display === 'flex') {
                    closeNewProjectModal();
                }
                if (activityModal.style.display === 'flex') {
                    closeActivityModal();
                }
                if (tasksModal.style.display === 'flex') {
                    closeProjectsTasksModal();
                }
                if (dateFilterModal.style.display === 'flex') {
                    closeDateFilterModal();
                }
                if (projectsFilterModal.style.display === 'flex') {
                    closeProjectsFilterModal();
                }
                if (advancedFiltersModal.style.display === 'flex') {
                    closeAdvancedFiltersModal();
                }
            }
        });

        function viewAllActivities() {
            alert('–ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π...');
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –ø–æ–ª–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π
        }

        // Activity Modal Functions - —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        function getActivityContent(type) {
            const activity = DataManager.activities.find(a => a.type === type);
            if (!activity) return null;

            if (type === 'task') {
                const task = DataManager.tasks.find(t => t.id === activity.id) || DataManager.tasks[0];
                return {
                    icon: activity.icon,
                    title: activity.title,
                    content: `
                        <div class="activity-detail-section">
                            <div class="detail-header">
                                <h3>${task.title}</h3>
                                <span class="status-badge ${activity.isNew ? 'new' : 'active'}">${activity.isNew ? '–ù–æ–≤–∞—è' : '–í —Ä–∞–±–æ—Ç–µ'}</span>
                            </div>
                            <div class="detail-grid">
                                <div class="detail-item">
                                    <div class="detail-label">üìÖ –°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</div>
                                    <div class="detail-value">${task.deadline}</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">üë§ –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π</div>
                                    <div class="detail-value">${task.assignee}</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">üìä –ü—Ä–æ–µ–∫—Ç</div>
                                    <div class="detail-value">${task.project}</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">‚≠ê –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</div>
                                    <div class="detail-value priority-${task.priority}">${task.priority === 'high' ? '–í—ã—Å–æ–∫–∏–π' : task.priority === 'medium' ? '–°—Ä–µ–¥–Ω–∏–π' : '–ù–∏–∑–∫–∏–π'}</div>
                                </div>
                            </div>
                            <div class="detail-description">
                                <div class="detail-label">üìÑ –û–ø–∏—Å–∞–Ω–∏–µ</div>
                                <p>${task.description}</p>
                            </div>
                            <div class="detail-checklist">
                                <div class="detail-label">‚úì –ü–æ–¥–∑–∞–¥–∞—á–∏</div>
                                <div class="checklist-item completed">
                                    <span class="check">‚úì</span> –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
                                </div>
                                <div class="checklist-item">
                                    <span class="check">‚óã</span> –í–∑—è—Ç—å –ø—Ä–æ–±—ã –±–µ—Ç–æ–Ω–∞
                                </div>
                                <div class="checklist-item">
                                    <span class="check">‚óã</span> –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—é
                                </div>
                            </div>
                        </div>
                    `,
                    actionText: '–û—Ç–∫—Ä—ã—Ç—å –∑–∞–¥–∞—á—É',
                    actionLink: 'projects.html?taskId=' + task.id
                };
            } else if (type === 'meeting') {
                const meeting = DataManager.meetings[0];
                return {
                    icon: activity.icon,
                    title: activity.title,
                    content: `
                        <div class="activity-detail-section">
                            <div class="detail-header">
                                <h3>${meeting.title}</h3>
                                <span class="status-badge completed">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</span>
                            </div>
                            <div class="detail-grid">
                                <div class="detail-item">
                                    <div class="detail-label">üìÖ –î–∞—Ç–∞</div>
                                    <div class="detail-value">${meeting.date}</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">‚è±Ô∏è –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</div>
                                    <div class="detail-value">${meeting.duration}</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">üë• –£—á–∞—Å—Ç–Ω–∏–∫–∏</div>
                                    <div class="detail-value">${meeting.participants} —á–µ–ª–æ–≤–µ–∫</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">üìç –ú–µ—Å—Ç–æ</div>
                                    <div class="detail-value">${meeting.location}</div>
                                </div>
                            </div>
                            <div class="detail-description">
                                <div class="detail-label">üìã –ü–æ–≤–µ—Å—Ç–∫–∞ –¥–Ω—è</div>
                                <ul class="agenda-list">
                                    ${meeting.agenda.map(item => `<li>${item}</li>`).join('')}
                                </ul>
                            </div>
                            <div class="detail-notes">
                                <div class="detail-label">üìù –ü—Ä–æ—Ç–æ–∫–æ–ª</div>
                                <p>${meeting.protocol}</p>
                            </div>
                        </div>
                    `,
                    actionText: '–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª',
                    actionLink: 'meetings.html'
                };
            } else if (type === 'document') {
                const doc = DataManager.documents[0];
                return {
                    icon: activity.icon,
                    title: activity.title,
                    content: `
                        <div class="activity-detail-section">
                            <div class="detail-header">
                                <h3>${doc.title}</h3>
                                <span class="status-badge updated">–û–±–Ω–æ–≤–ª–µ–Ω–æ</span>
                            </div>
                            <div class="detail-grid">
                                <div class="detail-item">
                                    <div class="detail-label">üìÖ –î–∞—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è</div>
                                    <div class="detail-value">${doc.updatedAt.toLocaleDateString('ru-RU')}</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">üë§ –ê–≤—Ç–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π</div>
                                    <div class="detail-value">${doc.author}</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">üì¶ –†–∞–∑–º–µ—Ä</div>
                                    <div class="detail-value">${doc.size}</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">üìä –í–µ—Ä—Å–∏—è</div>
                                    <div class="detail-value">${doc.version}</div>
                                </div>
                            </div>
                            <div class="detail-description">
                                <div class="detail-label">üìù –ò–∑–º–µ–Ω–µ–Ω–∏—è</div>
                                <ul class="changes-list">
                                    ${doc.changes.map(change => `
                                        <li>
                                            <span class="change-${change.type}">${change.type === 'added' ? '+' : change.type === 'modified' ? '~' : '-'}</span>
                                            ${change.text}
                                        </li>
                                    `).join('')}
                                </ul>
                            </div>
                            <div class="detail-tags">
                                <div class="detail-label">üè∑Ô∏è –¢–µ–≥–∏</div>
                                <div class="tags-container">
                                    ${doc.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                                </div>
                            </div>
                        </div>
                    `,
                    actionText: '–û—Ç–∫—Ä—ã—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç',
                    actionLink: 'documents.html'
                };
            } else if (type === 'payment') {
                const payment = DataManager.payments[0];
                return {
                    icon: activity.icon,
                    title: activity.title,
                    content: `
                        <div class="activity-detail-section">
                            <div class="detail-header">
                                <h3>${payment.title}</h3>
                                <span class="status-badge success">–£—Å–ø–µ—à–Ω–æ</span>
                            </div>
                            <div class="payment-amount">
                                <div class="amount-label">–°—É–º–º–∞ –ø–ª–∞—Ç–µ–∂–∞</div>
                                <div class="amount-value">‚Ç∏${payment.amount.toLocaleString('ru-RU')}</div>
                            </div>
                            <div class="detail-grid">
                                <div class="detail-item">
                                    <div class="detail-label">üìÖ –î–∞—Ç–∞ –ø–ª–∞—Ç–µ–∂–∞</div>
                                    <div class="detail-value">${payment.date}</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">üè¢ –ü–æ–ª—É—á–∞—Ç–µ–ª—å</div>
                                    <div class="detail-value">${payment.recipient}</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">üìä –ü—Ä–æ–µ–∫—Ç</div>
                                    <div class="detail-value">${payment.project}</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">üí≥ –°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</div>
                                    <div class="detail-value">${payment.method}</div>
                                </div>
                            </div>
                            <div class="detail-description">
                                <div class="detail-label">üìÑ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞</div>
                                <p>${payment.purpose}</p>
                            </div>
                            <div class="payment-status-timeline">
                                <div class="detail-label">üìä –°—Ç–∞—Ç—É—Å</div>
                                <div class="timeline">
                                    ${payment.timeline.map(item => `
                                        <div class="timeline-item ${item.completed ? 'completed' : ''}">
                                            <div class="timeline-dot"></div>
                                            <div class="timeline-content">
                                                <div class="timeline-title">${item.title}</div>
                                                <div class="timeline-time">${item.time}</div>
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                    `,
                    actionText: '–î–µ—Ç–∞–ª–∏ –ø–ª–∞—Ç–µ–∂–∞',
                    actionLink: 'finances.html'
                };
            } else if (type === 'project') {
                const project = DataManager.projects[0];
                return {
                    icon: activity.icon,
                    title: activity.title,
                    content: `
                        <div class="activity-detail-section">
                            <div class="detail-header">
                                <h3>${project.name} - –≠—Ç–∞–ø 2</h3>
                                <span class="status-badge active">–ê–∫—Ç–∏–≤–Ω—ã–π</span>
                            </div>
                            <div class="project-progress">
                                <div class="progress-header">
                                    <span>–ü—Ä–æ–≥—Ä–µ—Å—Å –ø—Ä–æ–µ–∫—Ç–∞</span>
                                    <span class="progress-percent">${project.progress}%</span>
                                </div>
                                <div class="progress-bar-container">
                                    <div class="progress-bar-fill" style="width: ${project.progress}%"></div>
                                </div>
                            </div>
                            <div class="detail-grid">
                                <div class="detail-item">
                                    <div class="detail-label">üìÖ –î–∞—Ç–∞ —Å—Ç–∞—Ä—Ç–∞</div>
                                    <div class="detail-value">${project.startDate}</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">üèÅ –ü–ª–∞–Ω–∏—Ä—É–µ–º–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ</div>
                                    <div class="detail-value">${project.endDate}</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">üë§ –ú–µ–Ω–µ–¥–∂–µ—Ä</div>
                                    <div class="detail-value">${project.manager}</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">üí∞ –ë—é–¥–∂–µ—Ç</div>
                                    <div class="detail-value">‚Ç∏${project.budget.toLocaleString('ru-RU')}</div>
                                </div>
                            </div>
                            <div class="detail-description">
                                <div class="detail-label">üìÑ –û–ø–∏—Å–∞–Ω–∏–µ</div>
                                <p>${project.description}</p>
                            </div>
                            <div class="project-stats">
                                <div class="stat-mini">
                                    <div class="stat-mini-icon">‚úÖ</div>
                                    <div class="stat-mini-info">
                                        <div class="stat-mini-value">${project.tasks.completed}</div>
                                        <div class="stat-mini-label">–ó–∞–¥–∞—á –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</div>
                                    </div>
                                </div>
                                <div class="stat-mini">
                                    <div class="stat-mini-icon">üìã</div>
                                    <div class="stat-mini-info">
                                        <div class="stat-mini-value">${project.tasks.total}</div>
                                        <div class="stat-mini-label">–í—Å–µ–≥–æ –∑–∞–¥–∞—á</div>
                                    </div>
                                </div>
                                <div class="stat-mini">
                                    <div class="stat-mini-icon">üë•</div>
                                    <div class="stat-mini-info">
                                        <div class="stat-mini-value">${project.team}</div>
                                        <div class="stat-mini-label">–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `,
                    actionText: '–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–µ–∫—Ç',
                    actionLink: 'projects.html'
                };
            }
            
            return null;
        }

        function openActivity(type) {
            const data = getActivityContent(type);
            if (!data) return;

            document.getElementById('activityModalIcon').textContent = data.icon;
            document.getElementById('activityModalTitleText').textContent = data.title;
            document.getElementById('activityModalBody').innerHTML = data.content;
            document.getElementById('activityActionText').textContent = data.actionText;
            document.getElementById('activityActionBtn').onclick = function() {
                window.location.href = data.actionLink;
            };

            document.getElementById('activityModal').style.display = 'flex';
            setTimeout(() => {
                document.querySelector('#activityModal .modal-content').classList.add('show');
            }, 10);
        }

        function closeActivityModal() {
            document.querySelector('#activityModal .modal-content').classList.remove('show');
            setTimeout(() => {
                document.getElementById('activityModal').style.display = 'none';
            }, 300);
        }

        // Projects Tasks Modal - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±—Ä–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏
        const allProjectTasks = [
            // –ó–∞–¥–∞—á–∏ –∏–∑ –≥—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤
            {
                id: 1,
                title: '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –±–µ—Ç–æ–Ω–∞ –Ω–∞ –æ–±—ä–µ–∫—Ç–µ',
                project: '–ñ–ö –ü—Ä–æ–≥—Ä–µ—Å—Å',
                projectColor: '#70B8B8',
                priority: 'high',
                status: 'urgent',
                deadline: '15 –æ–∫—Ç—è–±—Ä—è 2025',
                assignee: '–ê–π–≥—É–Ω –ê—Ö–º–µ—Ç–æ–≤–∞',
                progress: 33,
                source: '–ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç',
                tags: ['–ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞', '–°—Ä–æ—á–Ω–æ']
            },
            {
                id: 2,
                title: '–°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –≤–µ–Ω—Ç–∏–ª—è—Ü–∏–∏',
                project: '–ê—Å—Ç–∞–Ω–∞ Plaza',
                projectColor: '#10b981',
                priority: 'medium',
                status: 'today',
                deadline: '1 –æ–∫—Ç—è–±—Ä—è 2025',
                assignee: '–ò–Ω–∂–µ–Ω–µ—Ä –ü–µ—Ç—Ä–æ–≤',
                progress: 60,
                source: '–ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç',
                tags: ['–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è', '–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ']
            },
            {
                id: 3,
                title: '–ó–∞–∫–∞–∑–∞—Ç—å —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã',
                project: '–ñ–ö –ü—Ä–æ–≥—Ä–µ—Å—Å',
                projectColor: '#70B8B8',
                priority: 'high',
                status: 'today',
                deadline: '1 –æ–∫—Ç—è–±—Ä—è 2025',
                assignee: '–ú–µ–Ω–µ–¥–∂–µ—Ä –ø–æ –∑–∞–∫—É–ø–∫–∞–º',
                progress: 80,
                source: '–ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç',
                tags: ['–ó–∞–∫—É–ø–∫–∏', '–ú–∞—Ç–µ—Ä–∏–∞–ª—ã']
            },
            // –ó–∞–¥–∞—á–∏ –∏–∑ —Å–æ–≤–µ—â–∞–Ω–∏–π
            {
                id: 4,
                title: '–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –æ—Ç—á–µ—Ç –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞—Ö',
                project: '–ö–ª–∏–µ–Ω—Ç –ê',
                projectColor: '#f59e0b',
                priority: 'medium',
                status: 'today',
                deadline: '2 –æ–∫—Ç—è–±—Ä—è 2025',
                assignee: '–ê–π–≥—É–Ω –ê—Ö–º–µ—Ç–æ–≤–∞',
                progress: 45,
                source: '–°–æ–≤–µ—â–∞–Ω–∏–µ: –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –ø–ª–∞–Ω',
                tags: ['–û—Ç—á–µ—Ç–Ω–æ—Å—Ç—å', '–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è']
            },
            {
                id: 5,
                title: '–ü—Ä–æ–≤–µ—Å—Ç–∏ –∏–Ω—Å–ø–µ–∫—Ü–∏—é –æ–±—ä–µ–∫—Ç–∞',
                project: '–ê—Å—Ç–∞–Ω–∞ Plaza',
                projectColor: '#10b981',
                priority: 'high',
                status: 'urgent',
                deadline: '3 –æ–∫—Ç—è–±—Ä—è 2025',
                assignee: '–ì–ª–∞–≤–Ω—ã–π –∏–Ω–∂–µ–Ω–µ—Ä',
                progress: 20,
                source: '–°–æ–≤–µ—â–∞–Ω–∏–µ: –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –ø–ª–∞–Ω',
                tags: ['–ò–Ω—Å–ø–µ–∫—Ü–∏—è', '–ö–æ–Ω—Ç—Ä–æ–ª—å']
            },
            {
                id: 6,
                title: '–û–±–Ω–æ–≤–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é –Ω–µ–¥–µ–ª—é',
                project: '–ñ–ö –ü—Ä–æ–≥—Ä–µ—Å—Å',
                projectColor: '#70B8B8',
                priority: 'medium',
                status: 'normal',
                deadline: '5 –æ–∫—Ç—è–±—Ä—è 2025',
                assignee: '–ê–π–≥—É–Ω –ê—Ö–º–µ—Ç–æ–≤–∞',
                progress: 0,
                source: '–°–æ–≤–µ—â–∞–Ω–∏–µ: –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ',
                tags: ['–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ', '–ì—Ä–∞—Ñ–∏–∫']
            },
            // –ó–∞–¥–∞—á–∏ –∏–∑ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π
            {
                id: 7,
                title: '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ì–û–°–¢',
                project: '–ö–ª–∏–µ–Ω—Ç –ë',
                projectColor: '#8b5cf6',
                priority: 'low',
                status: 'normal',
                deadline: '8 –æ–∫—Ç—è–±—Ä—è 2025',
                assignee: '–ò–Ω–∂–µ–Ω–µ—Ä –ü–µ—Ç—Ä–æ–≤',
                progress: 70,
                source: '–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏',
                tags: ['–ì–û–°–¢', '–ü—Ä–æ–≤–µ—Ä–∫–∞']
            },
            {
                id: 8,
                title: '–û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –≤—Å—Ç—Ä–µ—á—É —Å –ø–æ–¥—Ä—è–¥—á–∏–∫–æ–º',
                project: '–ê—Å—Ç–∞–Ω–∞ Plaza',
                projectColor: '#10b981',
                priority: 'high',
                status: 'urgent',
                deadline: '2 –æ–∫—Ç—è–±—Ä—è 2025',
                assignee: '–ê–π–≥—É–Ω –ê—Ö–º–µ—Ç–æ–≤–∞',
                progress: 10,
                source: '–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏',
                tags: ['–í—Å—Ç—Ä–µ—á–∞', '–ü–æ–¥—Ä—è–¥—á–∏–∫']
            },
            {
                id: 9,
                title: '–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å—á–µ—Ç–∞ –Ω–∞ –æ–ø–ª–∞—Ç—É',
                project: '–ñ–ö –ü—Ä–æ–≥—Ä–µ—Å—Å',
                projectColor: '#70B8B8',
                priority: 'medium',
                status: 'overdue',
                deadline: '28 —Å–µ–Ω—Ç—è–±—Ä—è 2025',
                assignee: '–ë—É—Ö–≥–∞–ª—Ç–µ—Ä',
                progress: 90,
                source: '–§–∏–Ω–∞–Ω—Å—ã',
                tags: ['–û–ø–ª–∞—Ç–∞', '–§–∏–Ω–∞–Ω—Å—ã']
            },
            {
                id: 10,
                title: '–°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø—Ä–æ–µ–∫—Ç–µ',
                project: '–ö–ª–∏–µ–Ω—Ç –ê',
                projectColor: '#f59e0b',
                priority: 'high',
                status: 'today',
                deadline: '1 –æ–∫—Ç—è–±—Ä—è 2025',
                assignee: '–ì–ª–∞–≤–Ω—ã–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä',
                progress: 50,
                source: '–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏',
                tags: ['–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ', '–ò–∑–º–µ–Ω–µ–Ω–∏—è']
            },
            {
                id: 11,
                title: '–ü—Ä–æ–≤–µ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤',
                project: '–ö–ª–∏–µ–Ω—Ç –ë',
                projectColor: '#8b5cf6',
                priority: 'low',
                status: 'normal',
                deadline: '10 –æ–∫—Ç—è–±—Ä—è 2025',
                assignee: 'HR-–º–µ–Ω–µ–¥–∂–µ—Ä',
                progress: 25,
                source: '–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏',
                tags: ['–û–±—É—á–µ–Ω–∏–µ', 'HR']
            },
            {
                id: 12,
                title: '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏',
                project: '–ê—Å—Ç–∞–Ω–∞ Plaza',
                projectColor: '#10b981',
                priority: 'high',
                status: 'urgent',
                deadline: '1 –æ–∫—Ç—è–±—Ä—è 2025',
                assignee: '–ò–Ω–∂–µ–Ω–µ—Ä –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏',
                progress: 15,
                source: '–ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç',
                tags: ['–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å', '–ö–æ–Ω—Ç—Ä–æ–ª—å']
            },
            {
                id: 13,
                title: '–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é –¥–ª—è –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤',
                project: '–ñ–ö –ü—Ä–æ–≥—Ä–µ—Å—Å',
                projectColor: '#70B8B8',
                priority: 'medium',
                status: 'normal',
                deadline: '12 –æ–∫—Ç—è–±—Ä—è 2025',
                assignee: '–ú–∞—Ä–∫–µ—Ç–æ–ª–æ–≥',
                progress: 40,
                source: '–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏',
                tags: ['–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è', '–ò–Ω–≤–µ—Å—Ç–æ—Ä—ã']
            },
            {
                id: 14,
                title: '–û—Ñ–æ—Ä–º–∏—Ç—å —Ä–∞–∑—Ä–µ—à–∏—Ç–µ–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã',
                project: '–ö–ª–∏–µ–Ω—Ç –ê',
                projectColor: '#f59e0b',
                priority: 'high',
                status: 'overdue',
                deadline: '29 —Å–µ–Ω—Ç—è–±—Ä—è 2025',
                assignee: '–Æ—Ä–∏—Å—Ç',
                progress: 75,
                source: '–°–æ–≤–µ—â–∞–Ω–∏–µ',
                tags: ['–î–æ–∫—É–º–µ–Ω—Ç—ã', '–†–∞–∑—Ä–µ—à–µ–Ω–∏—è']
            },
            {
                id: 15,
                title: '–ó–∞–∫—É–ø–∏—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ñ–∏—Å–∞',
                project: '–ö–ª–∏–µ–Ω—Ç –ë',
                projectColor: '#8b5cf6',
                priority: 'low',
                status: 'normal',
                deadline: '15 –æ–∫—Ç—è–±—Ä—è 2025',
                assignee: '–û—Ñ–∏—Å-–º–µ–Ω–µ–¥–∂–µ—Ä',
                progress: 5,
                source: '–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏',
                tags: ['–ó–∞–∫—É–ø–∫–∏', '–û—Ñ–∏—Å']
            },
            {
                id: 16,
                title: '–ü—Ä–æ–≤–µ—Å—Ç–∏ –∞—É–¥–∏—Ç –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç',
                project: '–ê—Å—Ç–∞–Ω–∞ Plaza',
                projectColor: '#10b981',
                priority: 'medium',
                status: 'today',
                deadline: '1 –æ–∫—Ç—è–±—Ä—è 2025',
                assignee: '–ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä –∫–∞—á–µ—Å—Ç–≤–∞',
                progress: 30,
                source: '–ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç',
                tags: ['–ê—É–¥–∏—Ç', '–ö–∞—á–µ—Å—Ç–≤–æ']
            },
            {
                id: 17,
                title: '–û–±–Ω–æ–≤–∏—Ç—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é',
                project: '–ñ–ö –ü—Ä–æ–≥—Ä–µ—Å—Å',
                projectColor: '#70B8B8',
                priority: 'medium',
                status: 'normal',
                deadline: '7 –æ–∫—Ç—è–±—Ä—è 2025',
                assignee: '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ø–∏—Å–∞—Ç–µ–ª—å',
                progress: 55,
                source: '–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏',
                tags: ['–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è', '–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ']
            },
            {
                id: 18,
                title: '–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –±—é–¥–∂–µ—Ç–∞ –Ω–∞ –∫–≤–∞—Ä—Ç–∞–ª',
                project: '–ö–ª–∏–µ–Ω—Ç –ê',
                projectColor: '#f59e0b',
                priority: 'high',
                status: 'today',
                deadline: '2 –æ–∫—Ç—è–±—Ä—è 2025',
                assignee: '–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –¥–∏—Ä–µ–∫—Ç–æ—Ä',
                progress: 65,
                source: '–§–∏–Ω–∞–Ω—Å—ã',
                tags: ['–ë—é–¥–∂–µ—Ç', '–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ']
            },
            {
                id: 19,
                title: '–ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞',
                project: '–ö–ª–∏–µ–Ω—Ç –ë',
                projectColor: '#8b5cf6',
                priority: 'medium',
                status: 'normal',
                deadline: '9 –æ–∫—Ç—è–±—Ä—è 2025',
                assignee: 'IT-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç',
                progress: 20,
                source: '–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏',
                tags: ['IT', '–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥']
            },
            {
                id: 20,
                title: '–ü—Ä–æ–≤–µ—Å—Ç–∏ –≤—Å—Ç—Ä–µ—á—É —Å –∑–∞–∫–∞–∑—á–∏–∫–æ–º',
                project: '–ê—Å—Ç–∞–Ω–∞ Plaza',
                projectColor: '#10b981',
                priority: 'high',
                status: 'urgent',
                deadline: '1 –æ–∫—Ç—è–±—Ä—è 2025',
                assignee: '–ê–π–≥—É–Ω –ê—Ö–º–µ—Ç–æ–≤–∞',
                progress: 0,
                source: '–°–æ–≤–µ—â–∞–Ω–∏–µ',
                tags: ['–í—Å—Ç—Ä–µ—á–∞', '–ó–∞–∫–∞–∑—á–∏–∫']
            },
            {
                id: 21,
                title: '–ó–∞–∫–ª—é—á–∏—Ç—å –¥–æ–≥–æ–≤–æ—Ä —Å –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–º',
                project: '–ñ–ö –ü—Ä–æ–≥—Ä–µ—Å—Å',
                projectColor: '#70B8B8',
                priority: 'medium',
                status: 'normal',
                deadline: '6 –æ–∫—Ç—è–±—Ä—è 2025',
                assignee: '–ú–µ–Ω–µ–¥–∂–µ—Ä –ø–æ –∑–∞–∫—É–ø–∫–∞–º',
                progress: 85,
                source: '–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏',
                tags: ['–î–æ–≥–æ–≤–æ—Ä', '–ü–æ—Å—Ç–∞–≤—â–∏–∫']
            },
            {
                id: 22,
                title: '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–ª–∞–Ω–∞ –∑–∞ –º–µ—Å—è—Ü',
                project: '–ö–ª–∏–µ–Ω—Ç –ê',
                projectColor: '#f59e0b',
                priority: 'low',
                status: 'normal',
                deadline: '11 –æ–∫—Ç—è–±—Ä—è 2025',
                assignee: '–ê–Ω–∞–ª–∏—Ç–∏–∫',
                progress: 10,
                source: '–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏',
                tags: ['–ê–Ω–∞–ª–∏–∑', '–û—Ç—á–µ—Ç']
            },
            {
                id: 23,
                title: '–û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å —Ç—Ä–µ–Ω–∏–Ω–≥ –ø–æ —Ç–µ—Ö–Ω–∏–∫–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏',
                project: '–ö–ª–∏–µ–Ω—Ç –ë',
                projectColor: '#8b5cf6',
                priority: 'medium',
                status: 'overdue',
                deadline: '30 —Å–µ–Ω—Ç—è–±—Ä—è 2025',
                assignee: '–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –¢–ë',
                progress: 95,
                source: '–°–æ–≤–µ—â–∞–Ω–∏–µ',
                tags: ['–¢—Ä–µ–Ω–∏–Ω–≥', '–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å']
            },
            {
                id: 24,
                title: '–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Å–º–µ—Ç—É –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø',
                project: '–ê—Å—Ç–∞–Ω–∞ Plaza',
                projectColor: '#10b981',
                priority: 'high',
                status: 'today',
                deadline: '2 –æ–∫—Ç—è–±—Ä—è 2025',
                assignee: '–°–º–µ—Ç—á–∏–∫',
                progress: 40,
                source: '–ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç',
                tags: ['–°–º–µ—Ç–∞', '–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ']
            },
            {
                id: 25,
                title: '–ü—Ä–æ–≤–µ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞',
                project: '–ñ–ö –ü—Ä–æ–≥—Ä–µ—Å—Å',
                projectColor: '#70B8B8',
                priority: 'medium',
                status: 'normal',
                deadline: '8 –æ–∫—Ç—è–±—Ä—è 2025',
                assignee: '–†–∏—Å–∫-–º–µ–Ω–µ–¥–∂–µ—Ä',
                progress: 50,
                source: '–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏',
                tags: ['–†–∏—Å–∫–∏', '–ê–Ω–∞–ª–∏–∑']
            },
            {
                id: 26,
                title: '–û–±–Ω–æ–≤–∏—Ç—å CRM —Å–∏—Å—Ç–µ–º—É',
                project: '–ö–ª–∏–µ–Ω—Ç –ê',
                projectColor: '#f59e0b',
                priority: 'low',
                status: 'normal',
                deadline: '14 –æ–∫—Ç—è–±—Ä—è 2025',
                assignee: 'IT-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç',
                progress: 15,
                source: '–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏',
                tags: ['CRM', 'IT']
            },
            {
                id: 27,
                title: '–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∞–∫—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç',
                project: '–ö–ª–∏–µ–Ω—Ç –ë',
                projectColor: '#8b5cf6',
                priority: 'high',
                status: 'today',
                deadline: '1 –æ–∫—Ç—è–±—Ä—è 2025',
                assignee: '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å —Ä–∞–±–æ—Ç',
                progress: 70,
                source: '–ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç',
                tags: ['–ê–∫—Ç—ã', '–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è']
            },
            {
                id: 28,
                title: '–ü—Ä–æ–≤–µ—Å—Ç–∏ —Ä–µ–≤–∏–∑–∏—é —Å–∫–ª–∞–¥—Å–∫–∏—Ö –∑–∞–ø–∞—Å–æ–≤',
                project: '–ê—Å—Ç–∞–Ω–∞ Plaza',
                projectColor: '#10b981',
                priority: 'medium',
                status: 'normal',
                deadline: '10 –æ–∫—Ç—è–±—Ä—è 2025',
                assignee: '–ö–ª–∞–¥–æ–≤—â–∏–∫',
                progress: 35,
                source: '–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏',
                tags: ['–°–∫–ª–∞–¥', '–†–µ–≤–∏–∑–∏—è']
            }
        ];

        let currentTaskFilter = 'all';

        function openProjectsTasksModal() {
            renderTasks(currentTaskFilter);
            document.getElementById('projectsTasksModal').style.display = 'flex';
            setTimeout(() => {
                document.querySelector('#projectsTasksModal .modal-content').classList.add('show');
            }, 10);
        }

        function closeProjectsTasksModal() {
            document.querySelector('#projectsTasksModal .modal-content').classList.remove('show');
            setTimeout(() => {
                document.getElementById('projectsTasksModal').style.display = 'none';
            }, 300);
        }

        // Global filter state
        let activeFiltersState = {
            date: { type: 'today', label: '–°–µ–≥–æ–¥–Ω—è' },
            project: { type: 'all', label: '–í—Å–µ –ø—Ä–æ–µ–∫—Ç—ã' },
            advanced: {
                status: [],
                priority: [],
                assignee: [],
                progressRange: { min: 0, max: 100 },
                tags: []
            }
        };

        // Date Filter Functions
        function openDateFilter() {
            document.getElementById('dateFilterModal').style.display = 'flex';
            setTimeout(() => {
                document.querySelector('#dateFilterModal .modal-content').classList.add('show');
            }, 10);
        }

        function closeDateFilterModal() {
            document.querySelector('#dateFilterModal .modal-content').classList.remove('show');
            setTimeout(() => {
                document.getElementById('dateFilterModal').style.display = 'none';
            }, 300);
        }

        function selectDateFilter(dateType, label) {
            // Update button active state
            document.querySelectorAll('#dateFilterModal .filter-option-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-date="${dateType}"]`).classList.add('active');
            
            // Update filter display
            document.getElementById('selectedDate').textContent = label;
            
            // Save filter state
            activeFiltersState.date = { type: dateType, label: label };
            
            // Highlight button
            document.getElementById('dateFilterBtn').classList.add('filter-active');
            
            // Update active filters display
            updateActiveFiltersDisplay();
            
            // Apply filter logic
            console.log('–§–∏–ª—å—Ç—Ä –ø–æ –¥–∞—Ç–µ –ø—Ä–∏–º–µ–Ω–µ–Ω:', dateType);
            showSuccessMessage(`–§–∏–ª—å—Ç—Ä "${label}" –ø—Ä–∏–º–µ–Ω–µ–Ω`);
            applyFiltersToContent();
            
            // Close modal
            setTimeout(() => {
                closeDateFilterModal();
            }, 500);
        }

        // Projects Filter Functions
        function openProjectsFilter() {
            document.getElementById('projectsFilterModal').style.display = 'flex';
            setTimeout(() => {
                document.querySelector('#projectsFilterModal .modal-content').classList.add('show');
            }, 10);
        }

        function closeProjectsFilterModal() {
            document.querySelector('#projectsFilterModal .modal-content').classList.remove('show');
            setTimeout(() => {
                document.getElementById('projectsFilterModal').style.display = 'none';
            }, 300);
        }

        function selectProjectFilter(projectType, label) {
            // Update button active state
            document.querySelectorAll('#projectsFilterModal .filter-option-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-project="${projectType}"]`).classList.add('active');
            
            // Update filter display
            document.getElementById('selectedProject').textContent = label;
            
            // Save filter state
            activeFiltersState.project = { type: projectType, label: label };
            
            // Highlight button
            if (projectType !== 'all') {
                document.getElementById('projectFilterBtn').classList.add('filter-active');
            } else {
                document.getElementById('projectFilterBtn').classList.remove('filter-active');
            }
            
            // Update active filters display
            updateActiveFiltersDisplay();
            
            // Apply filter logic
            console.log('–§–∏–ª—å—Ç—Ä –ø–æ –ø—Ä–æ–µ–∫—Ç—É –ø—Ä–∏–º–µ–Ω–µ–Ω:', projectType);
            showSuccessMessage(`–ü—Ä–æ–µ–∫—Ç "${label}" –≤—ã–±—Ä–∞–Ω`);
            applyFiltersToContent();
            
            // Close modal
            setTimeout(() => {
                closeProjectsFilterModal();
            }, 500);
        }

        // Advanced Filters Functions
        function openAdvancedFilters() {
            document.getElementById('advancedFiltersModal').style.display = 'flex';
            setTimeout(() => {
                document.querySelector('#advancedFiltersModal .modal-content').classList.add('show');
            }, 10);
        }

        function closeAdvancedFiltersModal() {
            document.querySelector('#advancedFiltersModal .modal-content').classList.remove('show');
            setTimeout(() => {
                document.getElementById('advancedFiltersModal').style.display = 'none';
            }, 300);
        }

        function updateProgressRange() {
            const minVal = document.getElementById('progressRangeMin').value;
            const maxVal = document.getElementById('progressRangeMax').value;
            document.getElementById('progressMin').textContent = minVal + '%';
            document.getElementById('progressMax').textContent = maxVal + '%';
        }

        function resetAdvancedFilters() {
            // Reset checkboxes
            document.querySelectorAll('#advancedFiltersModal input[type="checkbox"]').forEach(checkbox => {
                checkbox.checked = true;
            });
            
            // Reset range sliders
            document.getElementById('progressRangeMin').value = 0;
            document.getElementById('progressRangeMax').value = 100;
            updateProgressRange();
            
            // Reset tag filters
            document.querySelectorAll('.tag-filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            showSuccessMessage('–§–∏–ª—å—Ç—Ä—ã —Å–±—Ä–æ—à–µ–Ω—ã');
        }

        function applyAdvancedFilters() {
            const filters = {
                status: [],
                priority: [],
                assignee: [],
                progressRange: {
                    min: document.getElementById('progressRangeMin').value,
                    max: document.getElementById('progressRangeMax').value
                },
                tags: []
            };

            // Collect selected filters
            document.querySelectorAll('#advancedFiltersModal input[type="checkbox"]:checked').forEach(checkbox => {
                const label = checkbox.nextElementSibling.textContent;
                if (checkbox.closest('.filter-section').querySelector('.filter-section-title').textContent === '–°—Ç–∞—Ç—É—Å') {
                    filters.status.push(label);
                } else if (checkbox.closest('.filter-section').querySelector('.filter-section-title').textContent === '–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç') {
                    filters.priority.push(label);
                } else if (checkbox.closest('.filter-section').querySelector('.filter-section-title').textContent === '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π') {
                    filters.assignee.push(label);
                }
            });

            document.querySelectorAll('.tag-filter-btn.active').forEach(btn => {
                filters.tags.push(btn.textContent);
            });

            // Save filter state
            activeFiltersState.advanced = filters;

            // Count active filters
            const filterCount = filters.status.length + filters.priority.length + 
                              filters.assignee.length + filters.tags.length;
            
            // Update badge
            const badge = document.getElementById('filterBadge');
            if (filterCount > 0) {
                badge.textContent = filterCount;
                badge.style.display = 'inline-block';
                document.getElementById('advancedFilterBtn').classList.add('filter-active');
            } else {
                badge.style.display = 'none';
                document.getElementById('advancedFilterBtn').classList.remove('filter-active');
            }

            // Update active filters display
            updateActiveFiltersDisplay();

            console.log('–ü—Ä–∏–º–µ–Ω–µ–Ω—ã —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã:', filters);
            showSuccessMessage('–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –ø—Ä–∏–º–µ–Ω–µ–Ω—ã');
            applyFiltersToContent();
            
            setTimeout(() => {
                closeAdvancedFiltersModal();
            }, 500);
        }

        // Update Active Filters Display
        function updateActiveFiltersDisplay() {
            // –í—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ
            return;
            
            const filtersList = document.getElementById('activeFiltersList');
            const filtersContainer = document.getElementById('activeFilters');
            if (!filtersList || !filtersContainer) return; // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ
            filtersList.innerHTML = '';
            
            let hasActiveFilters = false;

            // Add date filter if not default
            if (activeFiltersState.date.type !== 'today') {
                hasActiveFilters = true;
                filtersList.innerHTML += `
                    <div class="filter-chip">
                        <span class="chip-icon">üìÖ</span>
                        <span class="chip-text">${activeFiltersState.date.label}</span>
                        <button class="chip-remove" onclick="removeFilter('date')">√ó</button>
                    </div>
                `;
            }

            // Add project filter if not "all"
            if (activeFiltersState.project.type !== 'all') {
                hasActiveFilters = true;
                filtersList.innerHTML += `
                    <div class="filter-chip">
                        <span class="chip-icon">üìä</span>
                        <span class="chip-text">${activeFiltersState.project.label}</span>
                        <button class="chip-remove" onclick="removeFilter('project')">√ó</button>
                    </div>
                `;
            }

            // Add advanced filters
            const adv = activeFiltersState.advanced;
            
            adv.status.forEach(s => {
                hasActiveFilters = true;
                filtersList.innerHTML += `
                    <div class="filter-chip">
                        <span class="chip-icon">üìã</span>
                        <span class="chip-text">–°—Ç–∞—Ç—É—Å: ${s}</span>
                        <button class="chip-remove" onclick="removeAdvancedFilter('status', '${s}')">√ó</button>
                    </div>
                `;
            });

            adv.priority.forEach(p => {
                hasActiveFilters = true;
                filtersList.innerHTML += `
                    <div class="filter-chip">
                        <span class="chip-icon">‚≠ê</span>
                        <span class="chip-text">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: ${p}</span>
                        <button class="chip-remove" onclick="removeAdvancedFilter('priority', '${p}')">√ó</button>
                    </div>
                `;
            });

            adv.assignee.forEach(a => {
                hasActiveFilters = true;
                filtersList.innerHTML += `
                    <div class="filter-chip">
                        <span class="chip-icon">üë§</span>
                        <span class="chip-text">${a}</span>
                        <button class="chip-remove" onclick="removeAdvancedFilter('assignee', '${a}')">√ó</button>
                    </div>
                `;
            });

            adv.tags.forEach(t => {
                hasActiveFilters = true;
                filtersList.innerHTML += `
                    <div class="filter-chip">
                        <span class="chip-icon">üè∑Ô∏è</span>
                        <span class="chip-text">${t}</span>
                        <button class="chip-remove" onclick="removeAdvancedFilter('tags', '${t}')">√ó</button>
                    </div>
                `;
            });

            // Show/hide filters container
            filtersContainer.style.display = hasActiveFilters ? 'block' : 'none';
        }

        // Remove individual filter
        function removeFilter(type) {
            if (type === 'date') {
                selectDateFilter('today', '–°–µ–≥–æ–¥–Ω—è');
                document.getElementById('dateFilterBtn').classList.remove('filter-active');
            } else if (type === 'project') {
                selectProjectFilter('all', '–í—Å–µ –ø—Ä–æ–µ–∫—Ç—ã');
            }
        }

        function removeAdvancedFilter(category, value) {
            const index = activeFiltersState.advanced[category].indexOf(value);
            if (index > -1) {
                activeFiltersState.advanced[category].splice(index, 1);
            }
            updateActiveFiltersDisplay();
            applyFiltersToContent();
            
            // Update badge
            const filterCount = activeFiltersState.advanced.status.length + 
                              activeFiltersState.advanced.priority.length + 
                              activeFiltersState.advanced.assignee.length + 
                              activeFiltersState.advanced.tags.length;
            
            const badge = document.getElementById('filterBadge');
            if (filterCount > 0) {
                badge.textContent = filterCount;
                badge.style.display = 'inline-block';
            } else {
                badge.style.display = 'none';
                document.getElementById('advancedFilterBtn').classList.remove('filter-active');
            }
        }

        // Clear all filters
        function clearAllFilters() {
            activeFiltersState = {
                date: { type: 'today', label: '–°–µ–≥–æ–¥–Ω—è' },
                project: { type: 'all', label: '–í—Å–µ –ø—Ä–æ–µ–∫—Ç—ã' },
                advanced: {
                    status: [],
                    priority: [],
                    assignee: [],
                    progressRange: { min: 0, max: 100 },
                    tags: []
                }
            };
            
            document.getElementById('selectedDate').textContent = '–°–µ–≥–æ–¥–Ω—è';
            document.getElementById('selectedProject').textContent = '–í—Å–µ –ø—Ä–æ–µ–∫—Ç—ã';
            document.getElementById('dateFilterBtn').classList.remove('filter-active');
            document.getElementById('projectFilterBtn').classList.remove('filter-active');
            document.getElementById('advancedFilterBtn').classList.remove('filter-active');
            document.getElementById('filterBadge').style.display = 'none';
            
            updateActiveFiltersDisplay();
            applyFiltersToContent();
            showSuccessMessage('–í—Å–µ —Ñ–∏–ª—å—Ç—Ä—ã –æ—á–∏—â–µ–Ω—ã');
        }

        // Apply filters to content
        function applyFiltersToContent() {
            console.log('–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∫ –∫–æ–Ω—Ç–µ–Ω—Ç—É:', activeFiltersState);
            
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∫–∞—Ä—Ç–æ—á–µ–∫, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π –∏ —Ç.–¥.
            // –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–∫—Ä—ã–≤–∞—Ç—å/–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
            
            const message = `
                üìÖ –ü–µ—Ä–∏–æ–¥: ${activeFiltersState.date.label}
                üìä –ü—Ä–æ–µ–∫—Ç: ${activeFiltersState.project.label}
                üîç –î–æ–ø. —Ñ–∏–ª—å—Ç—Ä—ã: ${document.getElementById('filterBadge').textContent || '0'}
            `;
            
            console.log('–¢–µ–∫—É—â–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã:', message);
        }

        function filterTasks(status) {
            currentTaskFilter = status;
            renderTasks(status);
        }

        function renderTasks(filter) {
            let filteredTasks = allProjectTasks;

            if (filter === 'urgent') {
                filteredTasks = allProjectTasks.filter(t => t.status === 'urgent');
            } else if (filter === 'today') {
                filteredTasks = allProjectTasks.filter(t => t.status === 'today');
            } else if (filter === 'overdue') {
                filteredTasks = allProjectTasks.filter(t => t.status === 'overdue');
            }

            const tasksHtml = filteredTasks.map(task => `
                <div class="task-card" data-status="${task.status}">
                    <div class="task-card-header">
                        <div class="task-project-badge" style="background: ${task.projectColor}20; color: ${task.projectColor}; border-left: 4px solid ${task.projectColor};">
                            ${task.project}
                        </div>
                        <div class="task-priority priority-${task.priority}">
                            ${task.priority === 'high' ? 'üî¥ –í—ã—Å–æ–∫–∏–π' : task.priority === 'medium' ? 'üü° –°—Ä–µ–¥–Ω–∏–π' : 'üü¢ –ù–∏–∑–∫–∏–π'}
                        </div>
                    </div>
                    <h4 class="task-title">${task.title}</h4>
                    <div class="task-meta">
                        <div class="task-meta-item">
                            <span class="task-meta-icon">üìÖ</span>
                            <span>${task.deadline}</span>
                        </div>
                        <div class="task-meta-item">
                            <span class="task-meta-icon">üë§</span>
                            <span>${task.assignee}</span>
                        </div>
                        <div class="task-meta-item">
                            <span class="task-meta-icon">üìä</span>
                            <span>–ò–∑: ${task.source}</span>
                        </div>
                    </div>
                    <div class="task-progress-section">
                        <div class="task-progress-header">
                            <span>–ü—Ä–æ–≥—Ä–µ—Å—Å</span>
                            <span class="task-progress-value">${task.progress}%</span>
                        </div>
                        <div class="task-progress-bar">
                            <div class="task-progress-fill" style="width: ${task.progress}%; background: ${task.projectColor};"></div>
                        </div>
                    </div>
                    <div class="task-tags">
                        ${task.tags.map(tag => `<span class="task-tag">${tag}</span>`).join('')}
                    </div>
                </div>
            `).join('');

            document.getElementById('tasksModalBody').innerHTML = tasksHtml || '<div class="no-tasks">–ù–µ—Ç –∑–∞–¥–∞—á –≤ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</div>';
        }

        // Chart.js initialization with enhanced visuals
        let progressChart;
        
        const chartData = {
            '6m': {
                labels: ['–Ø–Ω–≤', '–§–µ–≤', '–ú–∞—Ä', '–ê–ø—Ä', '–ú–∞–π', '–ò—é–Ω'],
                datasets: [
                    {
                    label: '–ñ–ö –ü—Ä–æ–≥—Ä–µ—Å—Å',
                    data: [20, 35, 45, 60, 75, 85],
                    borderColor: '#70B8B8',
                        backgroundColor: createGradient('#70B8B8'),
                        tension: 0.4,
                        borderWidth: 3,
                        pointRadius: 5,
                        pointHoverRadius: 8,
                        pointBackgroundColor: '#70B8B8',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 3,
                        pointHoverBorderWidth: 4,
                        fill: true
                    },
                    {
                    label: '–ê—Å—Ç–∞–Ω–∞ Plaza',
                    data: [10, 25, 40, 55, 70, 80],
                    borderColor: '#10b981',
                        backgroundColor: createGradient('#10b981'),
                        tension: 0.4,
                        borderWidth: 3,
                        pointRadius: 5,
                        pointHoverRadius: 8,
                        pointBackgroundColor: '#10b981',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 3,
                        pointHoverBorderWidth: 4,
                        fill: true
                    },
                    {
                        label: '–ö–ª–∏–µ–Ω—Ç –ê',
                        data: [15, 28, 35, 48, 58, 65],
                        borderColor: '#f59e0b',
                        backgroundColor: createGradient('#f59e0b'),
                        tension: 0.4,
                        borderWidth: 3,
                        pointRadius: 5,
                        pointHoverRadius: 8,
                        pointBackgroundColor: '#f59e0b',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 3,
                        pointHoverBorderWidth: 4,
                        fill: true
                    },
                    {
                        label: '–ö–ª–∏–µ–Ω—Ç –ë',
                        data: [25, 38, 50, 58, 66, 72],
                        borderColor: '#8b5cf6',
                        backgroundColor: createGradient('#8b5cf6'),
                        tension: 0.4,
                        borderWidth: 3,
                        pointRadius: 5,
                        pointHoverRadius: 8,
                        pointBackgroundColor: '#8b5cf6',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 3,
                        pointHoverBorderWidth: 4,
                        fill: true
                    }
                ]
            },
            '3m': {
                labels: ['–ê–ø—Ä', '–ú–∞–π', '–ò—é–Ω'],
                datasets: [
                    {
                        label: '–ñ–ö –ü—Ä–æ–≥—Ä–µ—Å—Å',
                        data: [60, 75, 85],
                        borderColor: '#70B8B8',
                        backgroundColor: createGradient('#70B8B8'),
                        tension: 0.4,
                        borderWidth: 3,
                        pointRadius: 6,
                        pointHoverRadius: 9,
                        pointBackgroundColor: '#70B8B8',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 3,
                        fill: true
                    },
                    {
                        label: '–ê—Å—Ç–∞–Ω–∞ Plaza',
                        data: [55, 70, 80],
                        borderColor: '#10b981',
                        backgroundColor: createGradient('#10b981'),
                        tension: 0.4,
                        borderWidth: 3,
                        pointRadius: 6,
                        pointHoverRadius: 9,
                        pointBackgroundColor: '#10b981',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 3,
                        fill: true
                    },
                    {
                        label: '–ö–ª–∏–µ–Ω—Ç –ê',
                        data: [48, 58, 65],
                        borderColor: '#f59e0b',
                        backgroundColor: createGradient('#f59e0b'),
                        tension: 0.4,
                        borderWidth: 3,
                        pointRadius: 6,
                        pointHoverRadius: 9,
                        pointBackgroundColor: '#f59e0b',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 3,
                        fill: true
                    },
                    {
                        label: '–ö–ª–∏–µ–Ω—Ç –ë',
                        data: [58, 66, 72],
                        borderColor: '#8b5cf6',
                        backgroundColor: createGradient('#8b5cf6'),
                        tension: 0.4,
                        borderWidth: 3,
                        pointRadius: 6,
                        pointHoverRadius: 9,
                        pointBackgroundColor: '#8b5cf6',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 3,
                        fill: true
                    }
                ]
            },
            '1m': {
                labels: ['–ù–µ–¥ 1', '–ù–µ–¥ 2', '–ù–µ–¥ 3', '–ù–µ–¥ 4'],
                datasets: [
                    {
                        label: '–ñ–ö –ü—Ä–æ–≥—Ä–µ—Å—Å',
                        data: [75, 78, 82, 85],
                        borderColor: '#70B8B8',
                        backgroundColor: createGradient('#70B8B8'),
                        tension: 0.4,
                        borderWidth: 3,
                        pointRadius: 6,
                        pointHoverRadius: 9,
                        pointBackgroundColor: '#70B8B8',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 3,
                        fill: true
                    },
                    {
                        label: '–ê—Å—Ç–∞–Ω–∞ Plaza',
                        data: [70, 73, 77, 80],
                        borderColor: '#10b981',
                        backgroundColor: createGradient('#10b981'),
                        tension: 0.4,
                        borderWidth: 3,
                        pointRadius: 6,
                        pointHoverRadius: 9,
                        pointBackgroundColor: '#10b981',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 3,
                        fill: true
                    },
                    {
                        label: '–ö–ª–∏–µ–Ω—Ç –ê',
                        data: [58, 60, 63, 65],
                        borderColor: '#f59e0b',
                        backgroundColor: createGradient('#f59e0b'),
                        tension: 0.4,
                        borderWidth: 3,
                        pointRadius: 6,
                        pointHoverRadius: 9,
                        pointBackgroundColor: '#f59e0b',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 3,
                        fill: true
                    },
                    {
                        label: '–ö–ª–∏–µ–Ω—Ç –ë',
                        data: [66, 68, 70, 72],
                        borderColor: '#8b5cf6',
                        backgroundColor: createGradient('#8b5cf6'),
                        tension: 0.4,
                        borderWidth: 3,
                        pointRadius: 6,
                        pointHoverRadius: 9,
                        pointBackgroundColor: '#8b5cf6',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 3,
                        fill: true
                    }
                ]
            }
        };

        function createGradient(color) {
            const canvas = document.getElementById('progressChart');
            const ctx = canvas.getContext('2d');
            const gradient = ctx.createLinearGradient(0, 0, 0, 400);
            
            const colorMap = {
                '#70B8B8': ['rgba(112, 184, 184, 0.4)', 'rgba(112, 184, 184, 0.05)'],
                '#10b981': ['rgba(16, 185, 129, 0.4)', 'rgba(16, 185, 129, 0.05)'],
                '#f59e0b': ['rgba(245, 158, 11, 0.4)', 'rgba(245, 158, 11, 0.05)'],
                '#8b5cf6': ['rgba(139, 92, 246, 0.4)', 'rgba(139, 92, 246, 0.05)']
            };
            
            const colors = colorMap[color] || ['rgba(112, 184, 184, 0.3)', 'rgba(112, 184, 184, 0.05)'];
            gradient.addColorStop(0, colors[0]);
            gradient.addColorStop(1, colors[1]);
            
            return gradient;
        }

        function initChart(period = '6m') {
            const ctx = document.getElementById('progressChart').getContext('2d');
            
            // Update subtitle based on period
            const subtitles = {
                '6m': '–î–∏–Ω–∞–º–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤',
                '3m': '–î–∏–Ω–∞–º–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞',
                '1m': '–î–∏–Ω–∞–º–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü'
            };
            document.getElementById('chartSubtitle').textContent = subtitles[period] || subtitles['6m'];
            
            if (progressChart) {
                progressChart.destroy();
            }
            
            progressChart = new Chart(ctx, {
                type: 'line',
                data: chartData[period],
            options: {
                responsive: true,
                maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                plugins: {
                    legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(255, 255, 255, 0.98)',
                            titleColor: '#2c3e50',
                            bodyColor: '#666',
                            borderColor: '#e8eaed',
                            borderWidth: 2,
                            padding: 16,
                            displayColors: true,
                            cornerRadius: 12,
                            titleFont: {
                                size: 14,
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 13
                            },
                            boxWidth: 12,
                            boxHeight: 12,
                            boxPadding: 6,
                            usePointStyle: true,
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y + '%';
                                }
                            }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                            max: 100,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.06)',
                                drawBorder: false,
                                lineWidth: 1
                            },
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                },
                                font: {
                                    size: 13,
                                    weight: '500'
                                },
                                color: '#64748b',
                                padding: 10
                            }
                        },
                        x: {
                            grid: {
                                display: false,
                                drawBorder: false
                            },
                            ticks: {
                                font: {
                                    size: 13,
                                    weight: '600'
                                },
                                color: '#2c3e50',
                                padding: 10
                            }
                        }
                    },
                    animation: {
                        duration: 1500,
                        easing: 'easeInOutQuart'
                }
            }
        });
        }

        // Initialize chart on page load
        initChart('6m');

        // AI Chat Functions
        let isChatOpen = false;
        let isMinimized = false;

        function toggleAIChat() {
            const chatWindow = document.getElementById('aiChatWindow');
            const floatButton = document.querySelector('.ai-float-button');
            
            if (isChatOpen) {
                closeAIChat();
            } else {
                chatWindow.classList.add('show');
                floatButton.style.display = 'none';
                isChatOpen = true;
                isMinimized = false;
            }
        }

        function closeAIChat() {
            const chatWindow = document.getElementById('aiChatWindow');
            const floatButton = document.querySelector('.ai-float-button');
            
            chatWindow.classList.remove('show');
            chatWindow.classList.remove('minimized');
            setTimeout(() => {
                floatButton.style.display = 'flex';
            }, 300);
            isChatOpen = false;
            isMinimized = false;
        }

        function minimizeAIChat() {
            const chatWindow = document.getElementById('aiChatWindow');
            chatWindow.classList.toggle('minimized');
            isMinimized = !isMinimized;
        }

        function sendAIMessage() {
            const input = document.getElementById('aiChatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            addUserMessage(message);
            input.value = '';
            
            // Simulate AI response
            setTimeout(() => {
                addAIResponse(message);
            }, 1000);
        }

        function sendSuggestion(text) {
            addUserMessage(text);
            setTimeout(() => {
                addAIResponse(text);
            }, 1000);
        }

        function handleAIEnter(event) {
            if (event.key === 'Enter') {
                sendAIMessage();
            }
        }

        function addUserMessage(text) {
            const chatBody = document.getElementById('aiChatBody');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'user-message-container';
            messageDiv.innerHTML = `
                <div class="user-message">
                    <div class="message-text">${text}</div>
                </div>
                <div class="user-avatar-small">–ê–ê</div>
            `;
            chatBody.appendChild(messageDiv);
            chatBody.scrollTop = chatBody.scrollHeight;
        }

        function addAIResponse(userMessage) {
            const chatBody = document.getElementById('aiChatBody');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'ai-message-container';
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ–æ–±—â–µ–Ω–∏—è
            let response = '';
            if (userMessage.includes('–∑–∞–¥–∞—á') || userMessage.includes('–∑–∞–¥–∞—á–∏')) {
                response = '–£ –≤–∞—Å 28 –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á. 5 –∏–∑ –Ω–∏—Ö –ø—Ä–æ—Å—Ä–æ—á–µ–Ω—ã. –•–æ—Ç–∏—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã—Ö –∑–∞–¥–∞—á?';
            } else if (userMessage.includes('–ø—Ä–æ–µ–∫—Ç')) {
                response = '–í—Å–µ–≥–æ 4 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞: –ñ–ö –ü—Ä–æ–≥—Ä–µ—Å—Å (85%), –ê—Å—Ç–∞–Ω–∞ Plaza (80%), –ö–ª–∏–µ–Ω—Ç –ê (65%), –ö–ª–∏–µ–Ω—Ç –ë (72%). –ö–∞–∫–æ–π –ø—Ä–æ–µ–∫—Ç –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç?';
            } else if (userMessage.includes('—Ñ–∏–Ω–∞–Ω—Å') || userMessage.includes('–±—é–¥–∂–µ—Ç')) {
                response = '–û–±—â–∏–π –±—é–¥–∂–µ—Ç: ‚Ç∏2.4M. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ 85%. –ü–æ—Å–ª–µ–¥–Ω–∏–π –ø–ª–∞—Ç–µ–∂: ‚Ç∏450,000 –¥–ª—è –ê—Å—Ç–∞–Ω–∞ Plaza.';
            } else {
                response = '–Ø –º–æ–≥—É –ø–æ–º–æ—á—å –≤–∞–º —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –ø—Ä–æ–µ–∫—Ç–∞–º–∏, –∑–∞–¥–∞—á–∞–º–∏, —Å–æ–≤–µ—â–∞–Ω–∏—è–º–∏ –∏ —Ñ–∏–Ω–∞–Ω—Å–∞–º–∏. –ó–∞–¥–∞–π—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –≤–æ–ø—Ä–æ—Å!';
            }
            
            messageDiv.innerHTML = `
                <div class="ai-avatar">ü§ñ</div>
                <div class="ai-message">
                    <div class="ai-message-text typing">
                        <span class="typing-indicator">
                            <span></span><span></span><span></span>
                        </span>
                    </div>
                </div>
            `;
            chatBody.appendChild(messageDiv);
            chatBody.scrollTop = chatBody.scrollHeight;
            
            // Replace typing indicator with actual message
            setTimeout(() => {
                const messageText = messageDiv.querySelector('.ai-message-text');
                messageText.classList.remove('typing');
                messageText.innerHTML = response;
            }, 1500);
        }

        // Toggle dataset visibility
        function toggleDataset(datasetIndex) {
            if (!progressChart) return;
            
            const meta = progressChart.getDatasetMeta(datasetIndex);
            const legendItem = document.querySelector(`[data-dataset="${datasetIndex}"]`);
            
            // Toggle visibility
            meta.hidden = !meta.hidden;
            
            // Update legend appearance
            if (meta.hidden) {
                legendItem.classList.add('legend-hidden');
                legendItem.querySelector('.legend-toggle').textContent = 'üëÅÔ∏è‚Äçüó®Ô∏è';
            } else {
                legendItem.classList.remove('legend-hidden');
                legendItem.querySelector('.legend-toggle').textContent = 'üëÅÔ∏è';
            }
            
            // Update chart
            progressChart.update();
        }

        // Render Activities from DataManager
        function renderActivities() {
            const activitiesList = document.getElementById('activitiesList');
            const activities = DataManager.getRecentActivities(5);

            const activitiesHtml = activities.map(activity => `
                <div class="activity-item clickable" onclick="openActivity('${activity.type}')">
                    <div class="activity-icon ${activity.iconColor}">
                        <span>${activity.icon}</span>
                    </div>
                    <div class="activity-content">
                        <div class="activity-title">${activity.title}</div>
                        <div class="activity-description">${activity.description} - ${DataManager.formatTimeAgo(activity.timestamp)}</div>
                    </div>
                    ${activity.isNew ? '<div class="activity-badge new">–ù–æ–≤–æ–µ</div>' : ''}
                </div>
            `).join('');

            activitiesList.innerHTML = activitiesHtml;
        }

        // Priority buttons functionality
        let projectTags = [];

        document.addEventListener('DOMContentLoaded', function() {
            // Load activities from DataManager
            renderActivities();
            // Smooth scroll animation
            const cards = document.querySelectorAll('.stat-card, .activity-item');
            cards.forEach((card, index) => {
                card.style.animationDelay = `${index * 0.1}s`;
            });

            // Chart filter buttons
            const chartFilterButtons = document.querySelectorAll('.chart-filter-btn');
            chartFilterButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    chartFilterButtons.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    const period = this.dataset.period;
                    initChart(period);
                });
            });

            // Task filter buttons
            const taskFilterButtons = document.querySelectorAll('.task-filter-btn');
            taskFilterButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    taskFilterButtons.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    const filter = this.dataset.filter;
                    filterTasks(filter);
                });
            });

            // Tag filter buttons (toggle)
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('tag-filter-btn')) {
                    e.target.classList.toggle('active');
                }
            });

            // Priority buttons
            const priorityButtons = document.querySelectorAll('.priority-btn');
            priorityButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    priorityButtons.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    document.getElementById('projectPriority').value = this.dataset.priority;
                });
            });

            // Tags input
            const tagInput = document.getElementById('tagInput');
            tagInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    const tag = this.value.trim();
                    if (tag && !projectTags.includes(tag)) {
                        addTag(tag);
                        this.value = '';
                    }
                }
            });

            // Form submission
            document.getElementById('newProjectForm').addEventListener('submit', function(e) {
                e.preventDefault();
                handleProjectSubmit();
            });
        });

        function addTag(tag) {
            projectTags.push(tag);
            const tagsContainer = document.getElementById('tagsContainer');
            const tagElement = document.createElement('span');
            tagElement.className = 'tag';
            tagElement.innerHTML = `
                ${tag}
                <button type="button" class="remove-tag" onclick="removeTag('${tag}')">√ó</button>
            `;
            tagsContainer.appendChild(tagElement);
        }

        function removeTag(tag) {
            projectTags = projectTags.filter(t => t !== tag);
            const tagsContainer = document.getElementById('tagsContainer');
            const tags = tagsContainer.querySelectorAll('.tag');
            tags.forEach(tagEl => {
                if (tagEl.textContent.trim().replace('√ó', '').trim() === tag) {
                    tagEl.remove();
                }
            });
        }

        function handleProjectSubmit() {
            const formData = {
                name: document.getElementById('projectName').value,
                description: document.getElementById('projectDescription').value,
                budget: document.getElementById('projectBudget').value,
                status: document.getElementById('projectStatus').value,
                startDate: document.getElementById('projectStartDate').value,
                endDate: document.getElementById('projectEndDate').value,
                manager: document.getElementById('projectManager').value,
                priority: document.getElementById('projectPriority').value,
                tags: projectTags
            };

            console.log('–ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω:', formData);
            
            // Show success message
            showSuccessMessage('–ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!');
            
            // Close modal
            closeNewProjectModal();
        }

        function showSuccessMessage(message) {
            const successDiv = document.createElement('div');
            successDiv.className = 'success-notification';
            successDiv.innerHTML = `
                <span class="success-icon">‚úì</span>
                ${message}
            `;
            document.body.appendChild(successDiv);
            
            setTimeout(() => {
                successDiv.classList.add('show');
            }, 10);
            
            setTimeout(() => {
                successDiv.classList.remove('show');
                setTimeout(() => {
                    successDiv.remove();
                }, 300);
            }, 3000);
        }

        // Analytics Presentation Modal Functions
        let currentSlide = 0;
        
        function openAnalyticsPresentation() {
            const modal = document.getElementById('analyticsModal');
            modal.style.display = 'flex';
            setTimeout(() => {
                const content = modal.querySelector('.analytics-modal-content');
                content.classList.add('show');
            }, 10);
            currentSlide = 0;
            showSlide(currentSlide);
            updateAnalyticsData();
        }
        
        function closeAnalyticsModal() {
            const modal = document.getElementById('analyticsModal');
            const content = modal.querySelector('.analytics-modal-content');
            content.classList.remove('show');
            setTimeout(() => {
                modal.style.display = 'none';
            }, 300);
        }
        
        function updateAnalyticsData() {
            // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            const activeProjects = document.querySelector('.stat-card .stat-value')?.textContent || '15';
            const meetings = document.querySelectorAll('.stat-card')[1]?.querySelector('.stat-value')?.textContent || '8';
            const tasks = document.querySelectorAll('.stat-card')[2]?.querySelector('.stat-value')?.textContent || '42';
            const budget = document.querySelectorAll('.stat-card')[3]?.querySelector('.stat-value')?.textContent || '125M ‚Ç∏';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ª–∞–π–¥ 1 (–û–±–∑–æ—Ä)
            document.getElementById('slide1-projects').textContent = activeProjects;
            document.getElementById('slide1-meetings').textContent = meetings;
            document.getElementById('slide1-tasks').textContent = tasks;
            document.getElementById('slide1-budget').textContent = budget;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ª–∞–π–¥ 2 (–î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)
            document.getElementById('slide2-projects').textContent = activeProjects;
            document.getElementById('slide2-meetings').textContent = meetings;
            document.getElementById('slide2-tasks').textContent = tasks;
        }
        
        function showSlide(n) {
            const slides = document.querySelectorAll('.analytics-slide');
            const dots = document.querySelectorAll('.dot');
            
            if (n >= slides.length) {
                currentSlide = 0;
            }
            if (n < 0) {
                currentSlide = slides.length - 1;
            }
            
            slides.forEach((slide, index) => {
                slide.classList.remove('active');
                if (index === currentSlide) {
                    slide.classList.add('active');
                }
            });
            
            dots.forEach((dot, index) => {
                dot.classList.remove('active');
                if (index === currentSlide) {
                    dot.classList.add('active');
                }
            });
            
            document.getElementById('slideCounter').textContent = `${currentSlide + 1} / ${slides.length}`;
        }
        
        function nextSlide() {
            currentSlide++;
            showSlide(currentSlide);
        }
        
        function prevSlide() {
            currentSlide--;
            showSlide(currentSlide);
        }
        
        function goToSlide(n) {
            currentSlide = n;
            showSlide(currentSlide);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –º–µ–Ω—é
        document.addEventListener('DOMContentLoaded', function() {
            // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –º–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ
            if (typeof mobileMenu === 'undefined') {
                mobileMenu = new MobileMenu();
            }
        });
    </script>

    <!-- Analytics Presentation Modal -->
    <div id="analyticsModal" class="modal">
        <div class="analytics-modal-content modal-content">
            <div class="modal-header">
                <h2><span class="modal-icon">üìä</span> –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h2>
                <button onclick="closeAnalyticsModal()" class="close-modal">&times;</button>
            </div>
            
            <div class="analytics-modal-body">
                <!-- Slide Navigation -->
                <div class="slide-navigation">
                    <button onclick="prevSlide()" class="slide-nav-btn">
                        <span>‚Äπ</span>
                    </button>
                    
                    <!-- Slides Container -->
                    <div class="slides-container">
                        <!-- Slide 1: –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
                        <div class="analytics-slide active">
                            <div class="slide-header">
                                <h3>üìä –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                                <p class="slide-subtitle">–£–≥–ª—É–±–ª–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π</p>
                            </div>
                            
                            <div class="analytics-details">
                                <div class="detail-block">
                                    <div class="detail-block-header">
                                        <span class="detail-icon">üìã</span>
                                        <span class="detail-title">–°—Ä–æ–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤</span>
                                    </div>
                                    <div class="detail-stats">
                                        <div class="detail-stat-item">
                                            <span class="stat-label">–í—Å–µ–≥–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö:</span>
                                            <span class="stat-value" id="slide2-projects">4</span>
                                        </div>
                                        <div class="detail-stat-item">
                                            <span class="stat-label">–ó–∞–≤–µ—Ä—à–µ–Ω–æ –≤ —Å—Ä–æ–∫:</span>
                                            <span class="stat-value green">92%</span>
                                        </div>
                                        <div class="detail-stat-item">
                                            <span class="stat-label">–°—Ä–µ–¥–Ω–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å:</span>
                                            <span class="stat-value">78%</span>
                                        </div>
                                    </div>
                                    <div class="mini-progress-bar">
                                        <div class="mini-progress-fill" style="width: 78%"></div>
                                    </div>
                                </div>
                                
                                <div class="detail-block">
                                    <div class="detail-block-header">
                                        <span class="detail-icon">üí∞</span>
                                        <span class="detail-title">–ë—é–¥–∂–µ—Ç</span>
                                    </div>
                                    <div class="detail-stats">
                                        <div class="detail-stat-item">
                                            <span class="stat-label">–û–±—â–∏–π –±—é–¥–∂–µ—Ç:</span>
                                            <span class="stat-value" id="slide2-budget">‚Ç∏2.4M</span>
                                        </div>
                                        <div class="detail-stat-item">
                                            <span class="stat-label">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ:</span>
                                            <span class="stat-value orange">85%</span>
                                        </div>
                                        <div class="detail-stat-item">
                                            <span class="stat-label">–û—Å—Ç–∞—Ç–æ–∫:</span>
                                            <span class="stat-value green">‚Ç∏360K</span>
                                        </div>
                                    </div>
                                    <div class="mini-progress-bar">
                                        <div class="mini-progress-fill orange" style="width: 85%"></div>
                                    </div>
                                </div>
                                
                                <div class="detail-block">
                                    <div class="detail-block-header">
                                        <span class="detail-icon">‚úÖ</span>
                                        <span class="detail-title">–ó–∞–¥–∞—á–∏</span>
                                    </div>
                                    <div class="detail-stats">
                                        <div class="detail-stat-item">
                                            <span class="stat-label">–í —Ä–∞–±–æ—Ç–µ:</span>
                                            <span class="stat-value" id="slide2-tasks">28</span>
                                        </div>
                                        <div class="detail-stat-item">
                                            <span class="stat-label">–í—ã–ø–æ–ª–Ω–µ–Ω–æ –∑–∞ –Ω–µ–¥–µ–ª—é:</span>
                                            <span class="stat-value green">24</span>
                                        </div>
                                        <div class="detail-stat-item">
                                            <span class="stat-label">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ:</span>
                                            <span class="stat-value red">5</span>
                                        </div>
                                    </div>
                                    <div class="mini-progress-bar">
                                        <div class="mini-progress-fill green" style="width: 82%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Slide 2: –í—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ -->
                        <div class="analytics-slide">
                            <div class="slide-header">
                                <h3>üí° –í—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h3>
                                <p class="slide-subtitle">AI-–∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏</p>
                            </div>
                            
                            <div class="recommendations-container">
                                <div class="recommendation-card success">
                                    <div class="recommendation-icon">‚úÖ</div>
                                    <div class="recommendation-content">
                                        <h4>–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã</h4>
                                        <ul>
                                            <li>–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á (94%)</li>
                                            <li>–†–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ 15%</li>
                                            <li>–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—é–¥–∂–µ—Ç–æ–º</li>
                                        </ul>
                                    </div>
                                </div>
                                
                                <div class="recommendation-card warning">
                                    <div class="recommendation-icon">‚ö†Ô∏è</div>
                                    <div class="recommendation-content">
                                        <h4>–û–±–ª–∞—Å—Ç–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è</h4>
                                        <ul>
                                            <li>3 –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ —Ç—Ä–µ–±—É—é—Ç –≤–Ω–∏–º–∞–Ω–∏—è</li>
                                            <li>–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Å–æ–≤–µ—â–∞–Ω–∏–π</li>
                                            <li>–£—Å–∏–ª–∏—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å –∑–∞ —Å–æ–±–ª—é–¥–µ–Ω–∏–µ–º —Å—Ä–æ–∫–æ–≤</li>
                                        </ul>
                                    </div>
                                </div>
                                
                                <div class="recommendation-card info">
                                    <div class="recommendation-icon">üí°</div>
                                    <div class="recommendation-content">
                                        <h4>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ AI</h4>
                                        <ul>
                                            <li>–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å –ø–æ –ø—Ä–æ–µ–∫—Ç–∞–º</li>
                                            <li>–í–Ω–µ–¥—Ä–∏—Ç—å —Å–∏—Å—Ç–µ–º—É —Ä–∞–Ω–Ω–µ–≥–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ —Ä–∏—Å–∫–∞—Ö</li>
                                            <li>–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –º–µ–∂–¥—É –∫–æ–º–∞–Ω–¥–∞–º–∏</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <button onclick="nextSlide()" class="slide-nav-btn">
                        <span>‚Ä∫</span>
                    </button>
                </div>
                
                <!-- Slide Indicators -->
                <div class="slide-indicators">
                    <span class="dot active" onclick="goToSlide(0)"></span>
                    <span class="dot" onclick="goToSlide(1)"></span>
                </div>
                
                <div class="slide-counter" id="slideCounter">1 / 2</div>
            </div>
        </div>
    </div>

    <!-- Search Modal -->
    <div class="search-modal" id="searchModal">
        <div class="search-modal-content">
            <div class="search-modal-header">
                <div class="search-modal-input-container">
                    <span class="search-modal-icon">üîç</span>
                    <input type="text" id="searchModalInput" class="search-modal-input" placeholder="–ü–æ–∏—Å–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤, –∑–∞–¥–∞—á, –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤..." autofocus>
                    <button class="search-modal-close" onclick="closeSearchModal()">&times;</button>
                </div>
            </div>
            <div class="search-modal-body">
                <div class="search-suggestions">
                    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
                <div class="search-no-results" id="searchNoResults" style="display: none;">
                    <div class="search-no-results-icon">üîç</div>
                    <div class="search-no-results-text">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>
                    <div class="search-no-results-subtitle">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å</div>
                </div>
            </div>
            <div class="search-modal-footer">
                <div class="search-hint">
                    <span class="search-hint-key">‚Üµ</span> –í—ã–±—Ä–∞—Ç—å –ø–µ—Ä–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                </div>
                <div class="search-hint">
                    <span class="search-hint-key">ESC</span> –ó–∞–∫—Ä—ã—Ç—å
                </div>
            </div>
        </div>
    </div>

    <script>
        // Comprehensive search data
        const searchDatabase = {
            pages: [
                { title: '–ì–ª–∞–≤–Ω–∞—è', subtitle: '–û–±–∑–æ—Ä –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞', icon: 'üè†', url: 'index.html', keywords: ['–≥–ª–∞–≤–Ω–∞—è', '–¥–∞—à–±–æ—Ä–¥', 'dashboard', '—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞', '–æ–±–∑–æ—Ä', 'home'] },
                { title: '–ü—Ä–æ–µ–∫—Ç—ã', subtitle: '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏', icon: 'üìä', url: 'projects.html', keywords: ['–ø—Ä–æ–µ–∫—Ç—ã', '–∑–∞–¥–∞—á–∏', 'tasks', 'projects', '—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ'] },
                { title: '–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞', subtitle: '–î–æ–∫—É–º–µ–Ω—Ç—ã –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã', icon: 'üìö', url: 'documents.html', keywords: ['–±–∏–±–ª–∏–æ—Ç–µ–∫–∞', '–¥–æ–∫—É–º–µ–Ω—Ç—ã', 'library', 'files', '—Ñ–∞–π–ª—ã'] },
                { title: '–°–æ–≤–µ—â–∞–Ω–∏—è', subtitle: '–ö–∞–ª–µ–Ω–¥–∞—Ä—å –∏ –∏—Å—Ç–æ—Ä–∏—è', icon: 'üí¨', url: 'meetings.html', keywords: ['—Å–æ–≤–µ—â–∞–Ω–∏—è', 'meetings', '–≤—Å—Ç—Ä–µ—á–∏', '–∫–∞–ª–µ–Ω–¥–∞—Ä—å'] },
                { title: '–ê–Ω–∞–ª–∏—Ç–∏–∫–∞', subtitle: '–û—Ç—á—ë—Ç—ã –∏ –≥—Ä–∞—Ñ–∏–∫–∏', icon: 'üìà', url: '#', action: 'openAnalyticsPresentation', keywords: ['–∞–Ω–∞–ª–∏—Ç–∏–∫–∞', 'analytics', '–æ—Ç—á—ë—Ç—ã', '–≥—Ä–∞—Ñ–∏–∫–∏', '—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞'] }
            ],
            
            projects: [
                { title: '–ñ–ö –ü—Ä–æ–≥—Ä–µ—Å—Å', subtitle: '–ñ–∏–ª–æ–π –∫–æ–º–ø–ª–µ–∫—Å ‚Ä¢ 78% –∑–∞–≤–µ—Ä—à–µ–Ω–æ', icon: 'üèóÔ∏è', url: 'projects.html', keywords: ['–∂–∫', '–ø—Ä–æ–≥—Ä–µ—Å—Å', 'progress', '–∂–∏–ª–æ–π', '–∫–æ–º–ø–ª–µ–∫—Å', '—Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ'] },
                { title: '–ê—Å—Ç–∞–Ω–∞ Plaza', subtitle: '–ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä ‚Ä¢ 45% –∑–∞–≤–µ—Ä—à–µ–Ω–æ', icon: 'üè¢', url: 'projects.html', keywords: ['–∞—Å—Ç–∞–Ω–∞', 'plaza', '–∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π', '—Ü–µ–Ω—Ç—Ä', '–ø–ª–∞–∑–∞'] },
                { title: '–ö–ª–∏–µ–Ω—Ç –ê', subtitle: '–≠–∫—Å–ø–µ—Ä—Ç–∏–∑–∞ –ø—Ä–æ–µ–∫—Ç–∞', icon: 'üìã', url: 'projects.html', keywords: ['–∫–ª–∏–µ–Ω—Ç', '–∞', '—ç–∫—Å–ø–µ—Ä—Ç–∏–∑–∞', '–ø—Ä–æ–µ–∫—Ç'] },
                { title: '–ö–ª–∏–µ–Ω—Ç –ë', subtitle: '–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è', icon: 'üíº', url: 'projects.html', keywords: ['–∫–ª–∏–µ–Ω—Ç', '–±', '–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è'] }
            ],
            
            documentFolders: [
                { title: '–ù–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –†–ö', subtitle: '–ó–∞–∫–æ–Ω—ã, –ø–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è, –∫–æ–¥–µ–∫—Å—ã', icon: 'üìã', url: 'documents.html', keywords: ['–Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ', '–¥–æ–∫—É–º–µ–Ω—Ç—ã', '–∑–∞–∫–æ–Ω—ã', '—Ä–∫', '–∫–∞–∑–∞—Ö—Å—Ç–∞–Ω', '–ø–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è', '–∫–æ–¥–µ–∫—Å—ã'] },
                { title: '–ö–í–≠ - –≠–ª–µ–∫—Ç—Ä–æ—Å–Ω–∞–±–∂–µ–Ω–∏–µ', subtitle: '–ü—Ä–∞–≤–∏–ª–∞ –ø–æ –ö–í–≠ —Å –∏–∑–º. –Ω–∞ 26.02.2023', icon: '‚ö°', url: 'documents.html', keywords: ['–∫–≤—ç', '—ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ', '—ç–ª–µ–∫—Ç—Ä–æ—Å–Ω–∞–±–∂–µ–Ω–∏–µ', '–ø—Ä–∞–≤–∏–ª–∞'] },
                { title: '–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ', subtitle: '–°–ù –†–ö, –°–ù–∏–ü, –ì–û–°–¢, —Ä–µ–≥–ª–∞–º–µ–Ω—Ç—ã', icon: 'üèóÔ∏è', url: 'documents.html', keywords: ['—Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ', '—Å–Ω–∏–ø', '—Å–Ω —Ä–∫', '–≥–æ—Å—Ç', '—Ä–µ–≥–ª–∞–º–µ–Ω—Ç—ã', '—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ', '–Ω–æ—Ä–º—ã'] },
                { title: '–≠–∫–æ–ª–æ–≥–∏—è', subtitle: '–≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∫–æ–¥–µ–∫—Å –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏', icon: 'üåø', url: 'documents.html', keywords: ['—ç–∫–æ–ª–æ–≥–∏—è', 'environmental', '—ç–∫–æ', '–∫–æ–¥–µ–∫—Å', '–æ—Ü–µ–Ω–∫–∞'] },
                { title: '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏', subtitle: 'PMBOK 6, –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏, –æ–±—É—á–µ–Ω–∏–µ', icon: 'üìö', url: 'documents.html', keywords: ['—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ', '–ø—Ä–æ–µ–∫—Ç–∞–º–∏', 'pmbok', '–º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è', '–æ–±—É—á–µ–Ω–∏–µ', 'pm', 'project management'] }
            ],
            
            specificDocuments: [
                { title: 'PMBOK 6 (–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ)', subtitle: '–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –∫ –°–≤–æ–¥—É –∑–Ω–∞–Ω–∏–π –ø–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –ø—Ä–æ–µ–∫—Ç–∞–º–∏', icon: 'üìñ', url: 'documents.html', keywords: ['pmbok', '—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ', '—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ', '–ø—Ä–æ–µ–∫—Ç–∞–º–∏', '—Å–≤–æ–¥ –∑–Ω–∞–Ω–∏–π'] },
                { title: '–ü—Ä–∞–≤–∏–ª–∞ –ø–æ –ö–í–≠', subtitle: '—Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –Ω–∞ 26.02.2023', icon: '‚ö°', url: 'documents.html', keywords: ['–∫–≤—ç', '–ø—Ä–∞–≤–∏–ª–∞', '—ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ'] },
                { title: '–°–ù –†–ö 1.02-03-2022', subtitle: '–°—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–æ—Ä–º—ã –†–ö', icon: 'üèóÔ∏è', url: 'documents.html', keywords: ['—Å–Ω —Ä–∫', '—Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–µ', '–Ω–æ—Ä–º—ã'] },
                { title: '–≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∫–æ–¥–µ–∫—Å –†–ö', subtitle: '—Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –Ω–∞ 07.03.2023', icon: 'üåø', url: 'documents.html', keywords: ['—ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π', '–∫–æ–¥–µ–∫—Å', '—ç–∫ —Ä–∫'] },
                { title: '–ó–†–ö –û–± –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ', subtitle: '–ó–∞–∫–æ–Ω –æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–π –∏ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏', icon: 'üìã', url: 'documents.html', keywords: ['–∑–∞–∫–æ–Ω', '–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞', '—Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ', '–∑—Ä–∫'] },
                { title: '–ù–î–¶–° –†–ö 8.01-08-2022', subtitle: '–ü–æ—Ä—è–¥–æ–∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏', icon: 'üìÑ', url: 'documents.html', keywords: ['–Ω–¥—Ü—Å', '–ø–æ—Ä—è–¥–æ–∫', '–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è', '—Å–ª–æ–∂–Ω–æ—Å—Ç—å'] },
                { title: 'Microsoft Project 2016', subtitle: '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏ —Å MS Project', icon: 'üíª', url: 'documents.html', keywords: ['microsoft', 'project', '–º—Å –ø—Ä–æ–¥–∂–µ–∫—Ç', '–æ–±—É—á–µ–Ω–∏–µ'] }
            ],
            
            meetings: [
                { title: '–£—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ–≤–µ—â–∞–Ω–∏–µ', subtitle: '–û–±—Å—É–∂–¥–µ–Ω–∏–µ –ø–ª–∞–Ω–æ–≤ –Ω–∞ –Ω–µ–¥–µ–ª—é', icon: '‚òÄÔ∏è', url: 'meetings.html', keywords: ['—É—Ç—Ä–µ–Ω–Ω–µ–µ', '—Å–æ–≤–µ—â–∞–Ω–∏–µ', '–ø–ª–∞–Ω—ã', '–Ω–µ–¥–µ–ª—è'] },
                { title: '–û–±—Å—É–∂–¥–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –ê—Å—Ç–∞–Ω–∞ Plaza', subtitle: '–ü—Ä–æ–µ–∫—Ç "–ê—Å—Ç–∞–Ω–∞ Plaza"', icon: 'üè¢', url: 'meetings.html', keywords: ['–∞—Å—Ç–∞–Ω–∞', 'plaza', '–æ–±—Å—É–∂–¥–µ–Ω–∏–µ', '–ø—Ä–æ–µ–∫—Ç'] },
                { title: '–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø—Ä–∏–Ω—Ç–∞', subtitle: 'Sprint Planning', icon: 'üìÖ', url: 'meetings.html', keywords: ['–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ', '—Å–ø—Ä–∏–Ω—Ç', 'sprint', 'planning'] },
                { title: '–í—Å—Ç—Ä–µ—á–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º', subtitle: '–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞', icon: 'üë•', url: 'meetings.html', keywords: ['–≤—Å—Ç—Ä–µ—á–∞', '–∫–ª–∏–µ–Ω—Ç', '–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è', '–ø—Ä–æ–≥—Ä–µ—Å—Å'] },
                { title: '–†–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–∞', subtitle: '–û–±—Å—É–∂–¥–µ–Ω–∏–µ –∏—Ç–æ–≥–æ–≤ —Å–ø—Ä–∏–Ω—Ç–∞', icon: 'üîÑ', url: 'meetings.html', keywords: ['—Ä–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–∞', 'retrospective', '–∏—Ç–æ–≥–∏', '—Å–ø—Ä–∏–Ω—Ç'] },
                { title: '–î–µ–º–æ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è', subtitle: '–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π', icon: 'üéØ', url: 'meetings.html', keywords: ['–¥–µ–º–æ', 'demo', '–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è', '—Ñ—É–Ω–∫—Ü–∏–∏'] },
                { title: '–ü—Ä–æ—Ç–æ–∫–æ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏', subtitle: '–§–æ—Ä–º–∞ –∫–æ–Ω—Ç—Ä–æ–ª—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á', icon: 'üìù', url: 'meetings.html', action: 'openProtocolModal', keywords: ['–ø—Ä–æ—Ç–æ–∫–æ–ª—å–Ω—ã–µ', '–∑–∞–¥–∞—á–∏', '–∫–æ–Ω—Ç—Ä–æ–ª—å', '–∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ'] }
            ],
            
            activities: [
                { title: '–ó–∞–≤–µ—Ä—à–µ–Ω–∞ –∑–∞–¥–∞—á–∞ –ø–æ –ñ–ö –ü—Ä–æ–≥—Ä–µ—Å—Å', subtitle: '–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏', icon: '‚úÖ', url: 'index.html', keywords: ['–∑–∞–¥–∞—á–∞', '–∑–∞–≤–µ—Ä—à–µ–Ω–∞', '–∂–∫', '–ø—Ä–æ–≥—Ä–µ—Å—Å', '–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å'] },
                { title: '–ù–æ–≤–æ–µ —Å–æ–≤–µ—â–∞–Ω–∏–µ', subtitle: '–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ —Å–æ–≤–µ—â–∞–Ω–∏–µ', icon: 'üìÖ', url: 'meetings.html', keywords: ['—Å–æ–≤–µ—â–∞–Ω–∏–µ', '–Ω–æ–≤–æ–µ', '–∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ'] },
                { title: '–û–±–Ω–æ–≤–ª–µ–Ω –¥–æ–∫—É–º–µ–Ω—Ç', subtitle: '–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø—Ä–æ–µ–∫—Ç–µ', icon: 'üìÑ', url: 'documents.html', keywords: ['–¥–æ–∫—É–º–µ–Ω—Ç', '–æ–±–Ω–æ–≤–ª–µ–Ω', '–∏–∑–º–µ–Ω–µ–Ω–∏—è'] },
                { title: '–ü–ª–∞—Ç–µ–∂ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω', subtitle: '–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è', icon: 'üí∞', url: 'finances.html', keywords: ['–ø–ª–∞—Ç–µ–∂', '–æ–ø–ª–∞—Ç–∞', '—Ñ–∏–Ω–∞–Ω—Å—ã'] }
            ],
            
            statistics: [
                { title: '–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤', subtitle: '4 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞', icon: 'üìä', url: 'index.html', keywords: ['—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞', '–ø—Ä–æ–µ–∫—Ç—ã', '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ'] },
                { title: '–°–æ–≤–µ—â–∞–Ω–∏—è - 12', subtitle: '3 —Å–æ–≤–µ—â–∞–Ω–∏—è —Å–µ–≥–æ–¥–Ω—è', icon: 'üí¨', url: 'meetings.html', keywords: ['—Å–æ–≤–µ—â–∞–Ω–∏—è', '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ', '—Å–µ–≥–æ–¥–Ω—è'] },
                { title: '–ó–∞–¥–∞—á–∏ - 28', subtitle: '5 –∑–∞–¥–∞—á –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–æ', icon: '‚úÖ', url: 'projects.html', keywords: ['–∑–∞–¥–∞—á–∏', '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ', '–ø—Ä–æ—Å—Ä–æ—á–µ–Ω–æ'] },
                { title: '–ë—é–¥–∂–µ—Ç - ‚Ç∏2.4M', subtitle: '85% –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ', icon: 'üí∞', url: 'finances.html', keywords: ['–±—é–¥–∂–µ—Ç', '—Ñ–∏–Ω–∞–Ω—Å—ã', '–¥–µ–Ω—å–≥–∏', '—Ç–µ–Ω–≥–µ'] },
                { title: '–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤', subtitle: '–î–∏–Ω–∞–º–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞ 6 –º–µ—Å—è—Ü–µ–≤', icon: 'üìà', url: 'index.html', keywords: ['–≥—Ä–∞—Ñ–∏–∫', '–ø—Ä–æ–≥—Ä–µ—Å—Å', '–¥–∏–Ω–∞–º–∏–∫–∞', 'chart'] }
            ],
            
            actions: [
                { title: '–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç', subtitle: '–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –≤ —Å–∏—Å—Ç–µ–º—É', icon: '‚ûï', url: '#', action: 'createNewProject', keywords: ['—Å–æ–∑–¥–∞—Ç—å', '–Ω–æ–≤—ã–π', '–ø—Ä–æ–µ–∫—Ç', '–¥–æ–±–∞–≤–∏—Ç—å'] },
                { title: '–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É', subtitle: '–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É', icon: '‚úÖ', url: 'projects.html', keywords: ['–∑–∞–¥–∞—á–∞', 'task', '—Å–æ–∑–¥–∞—Ç—å', '–¥–æ–±–∞–≤–∏—Ç—å'] },
                { title: '–î–æ–±–∞–≤–∏—Ç—å —Å–æ–≤–µ—â–∞–Ω–∏–µ', subtitle: '–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –≤—Å—Ç—Ä–µ—á—É', icon: 'üìÖ', url: 'meetings.html', keywords: ['—Å–æ–≤–µ—â–∞–Ω–∏–µ', '–¥–æ–±–∞–≤–∏—Ç—å', '–≤—Å—Ç—Ä–µ—á–∞', '–∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å'] },
                { title: '–ù–∞–∑–Ω–∞—á–∏—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ', subtitle: '–†–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∑–∞–¥–∞—á–∏', icon: 'üë§', url: 'projects.html', keywords: ['–Ω–∞–∑–Ω–∞—á–∏—Ç—å', '–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π', '—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å'] },
                { title: '–≠–∫—Å–ø–æ—Ä—Ç –≤ Excel', subtitle: '–í—ã–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ', icon: 'üì•', url: 'meetings.html', keywords: ['—ç–∫—Å–ø–æ—Ä—Ç', 'excel', '–≤—ã–≥—Ä—É–∑–∫–∞', '–¥–∞–Ω–Ω—ã–µ'] }
            ],
            
            features: [
                { title: 'AI-–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç', subtitle: '–£–º–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è —Ä–∞–±–æ—Ç—ã', icon: 'ü§ñ', url: '#', action: 'toggleAIChat', keywords: ['ai', '–∏–∏', '–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç', '–ø–æ–º–æ—â–Ω–∏–∫', '—á–∞—Ç', '–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç'] },
                { title: '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è', subtitle: '–ü—Ä–æ—Å–º–æ—Ç—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π', icon: 'üîî', url: '#', keywords: ['—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è', 'notifications', 'alerts', '–æ–ø–æ–≤–µ—â–µ–Ω–∏—è'] },
                { title: '–ù–∞—Å—Ç—Ä–æ–π–∫–∏', subtitle: '–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∏—Å—Ç–µ–º—ã', icon: '‚öôÔ∏è', url: '#', keywords: ['–Ω–∞—Å—Ç—Ä–æ–π–∫–∏', 'settings', '–ø–∞—Ä–∞–º–µ—Ç—Ä—ã', '–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è'] },
                { title: '–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', subtitle: '–õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏', icon: 'üë§', url: '#', keywords: ['–ø—Ä–æ—Ñ–∏–ª—å', 'profile', '–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å', '–∞–∫–∫–∞—É–Ω—Ç', 'account'] },
                { title: '–í—ã–π—Ç–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã', subtitle: '–ó–∞–≤–µ—Ä—à–∏—Ç—å —Å–µ–∞–Ω—Å', icon: 'üö™', url: '#', action: 'logout', keywords: ['–≤—ã–π—Ç–∏', 'logout', '–≤—ã—Ö–æ–¥', '–∑–∞–≤–µ—Ä—à–∏—Ç—å'] }
            ]
        };

        // Search Modal Functions
        function openSearchModal() {
            const modal = document.getElementById('searchModal');
            const input = document.getElementById('searchModalInput');
            modal.style.display = 'flex';
            setTimeout(() => {
                modal.classList.add('show');
                input.focus();
            }, 10);
            renderSearchResults(''); // Show all initially
        }

        function closeSearchModal() {
            const modal = document.getElementById('searchModal');
            modal.classList.remove('show');
            setTimeout(() => {
                modal.style.display = 'none';
                document.getElementById('searchModalInput').value = '';
            }, 300);
        }

        // Smart search function
        function performSearch(query) {
            if (!query) return { pages: [], projects: [], documents: [], tasks: [], features: [] };
            
            const results = {
                pages: [],
                projects: [],
                documents: [],
                tasks: [],
                features: []
            };
            
            const queryLower = query.toLowerCase();
            
            // Search through all categories
            Object.keys(searchDatabase).forEach(category => {
                searchDatabase[category].forEach(item => {
                    let score = 0;
                    const titleLower = item.title.toLowerCase();
                    const subtitleLower = item.subtitle.toLowerCase();
                    const keywords = item.keywords || [];
                    
                    // Exact title match - highest priority
                    if (titleLower === queryLower) score += 100;
                    // Title starts with query
                    else if (titleLower.startsWith(queryLower)) score += 50;
                    // Title contains query
                    else if (titleLower.includes(queryLower)) score += 30;
                    
                    // Subtitle match
                    if (subtitleLower.includes(queryLower)) score += 20;
                    
                    // Keyword match
                    keywords.forEach(keyword => {
                        if (keyword.toLowerCase().includes(queryLower)) score += 15;
                        if (keyword.toLowerCase() === queryLower) score += 25;
                    });
                    
                    if (score > 0) {
                        results[category].push({ ...item, score });
                    }
                });
                
                // Sort by score
                results[category].sort((a, b) => b.score - a.score);
            });
            
            return results;
        }

        // Render search results
        function renderSearchResults(query) {
            const suggestionsContainer = document.querySelector('.search-suggestions');
            const noResults = document.getElementById('searchNoResults');
            
            if (!query.trim()) {
                // Show default categories
                suggestionsContainer.innerHTML = `
                    <div class="search-category">
                        <h4>–ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø</h4>
                        <div class="search-items">
                            ${searchDatabase.pages.map(item => createSearchItem(item)).join('')}
                        </div>
                    </div>
                    
                    <div class="search-category">
                        <h4>–ü—Ä–æ–µ–∫—Ç—ã</h4>
                        <div class="search-items">
                            ${searchDatabase.projects.map(item => createSearchItem(item)).join('')}
                        </div>
                    </div>
                    
                    <div class="search-category">
                        <h4>–ù–µ–¥–∞–≤–Ω–∏–µ —Å–æ–≤–µ—â–∞–Ω–∏—è</h4>
                        <div class="search-items">
                            ${searchDatabase.meetings.slice(0, 4).map(item => createSearchItem(item)).join('')}
                        </div>
                    </div>
                    
                    <div class="search-category">
                        <h4>–ü–∞–ø–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</h4>
                        <div class="search-items">
                            ${searchDatabase.documentFolders.map(item => createSearchItem(item)).join('')}
                        </div>
                    </div>
                `;
                noResults.style.display = 'none';
                return;
            }
            
            const results = performSearch(query);
            const hasResults = Object.values(results).some(arr => arr.length > 0);
            
            if (!hasResults) {
                suggestionsContainer.innerHTML = '';
                noResults.style.display = 'flex';
                return;
            }
            
            noResults.style.display = 'none';
            let html = '';
            
            const categoryNames = {
                pages: '–°—Ç—Ä–∞–Ω–∏—Ü—ã',
                projects: '–ü—Ä–æ–µ–∫—Ç—ã',
                documentFolders: '–ü–∞–ø–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤',
                specificDocuments: '–î–æ–∫—É–º–µ–Ω—Ç—ã',
                meetings: '–°–æ–≤–µ—â–∞–Ω–∏—è',
                activities: '–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏',
                statistics: '–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞',
                actions: '–î–µ–π—Å—Ç–≤–∏—è',
                features: '–§—É–Ω–∫—Ü–∏–∏'
            };
            
            Object.keys(results).forEach(category => {
                if (results[category].length > 0) {
                    html += `
                        <div class="search-category">
                            <h4>${categoryNames[category]} <span class="category-count">(${results[category].length})</span></h4>
                            <div class="search-items">
                                ${results[category].map(item => createSearchItem(item, query)).join('')}
                            </div>
                        </div>
                    `;
                }
            });
            
            suggestionsContainer.innerHTML = html;
        }

        // Create search item HTML
        function createSearchItem(item, query = '') {
            const highlightedTitle = query ? highlightText(item.title, query) : item.title;
            const highlightedSubtitle = query ? highlightText(item.subtitle, query) : item.subtitle;
            
            const action = item.action ? 
                `onclick="${item.action}(); closeSearchModal();"` : 
                `onclick="window.location.href='${item.url}'"`;
            
            return `
                <div class="search-item" ${action}>
                    <span class="search-item-icon">${item.icon}</span>
                    <div class="search-item-content">
                        <div class="search-item-title">${highlightedTitle}</div>
                        <div class="search-item-subtitle">${highlightedSubtitle}</div>
                    </div>
                    ${item.score ? `<div class="search-item-badge">–°–æ–≤–ø–∞–¥–µ–Ω–∏–µ ${Math.min(100, Math.round(item.score))}%</div>` : ''}
                </div>
            `;
        }

        // Highlight matching text
        function highlightText(text, query) {
            if (!query) return text;
            const regex = new RegExp(`(${query})`, 'gi');
            return text.replace(regex, '<mark>$1</mark>');
        }

        // Open modal on search input click
        document.getElementById('global-search').addEventListener('click', function(e) {
            e.preventDefault();
            openSearchModal();
        });

        // Close modal on ESC key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeSearchModal();
            }
        });

        // Close modal on backdrop click
        document.getElementById('searchModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeSearchModal();
            }
        });

        // Search functionality
        document.getElementById('searchModalInput').addEventListener('input', function(e) {
            const query = e.target.value.trim();
            renderSearchResults(query);
        });

        // Handle Enter key to navigate to first result
        document.getElementById('searchModalInput').addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                const firstItem = document.querySelector('.search-item');
                if (firstItem) {
                    firstItem.click();
                }
            }
        });
    </script>

</body>
</html>

