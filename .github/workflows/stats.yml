name: Project Statistics

on:
  schedule:
    - cron: '0 0 * * 0'  # Каждое воскресенье в полночь
  workflow_dispatch:  # Позволяет запускать вручную

jobs:
  stats:
    name: Generate project statistics
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        
      - name: Calculate statistics
        run: |
          echo "# 📊 PRIME360.AI - Статистика проекта" > stats.txt
          echo "" >> stats.txt
          echo "Дата: $(date)" >> stats.txt
          echo "" >> stats.txt
          
          echo "## 📁 Структура проекта" >> stats.txt
          echo "" >> stats.txt
          echo "- HTML страниц: $(find . -name '*.html' | wc -l)" >> stats.txt
          echo "- CSS файлов: $(find . -name '*.css' | wc -l)" >> stats.txt
          echo "- JavaScript файлов: $(find . -name '*.js' | wc -l)" >> stats.txt
          echo "- Markdown документов: $(find . -name '*.md' | wc -l)" >> stats.txt
          echo "" >> stats.txt
          
          echo "## 📝 Строки кода" >> stats.txt
          echo "" >> stats.txt
          echo "\`\`\`" >> stats.txt
          find . -name '*.html' -o -name '*.css' -o -name '*.js' | xargs wc -l | tail -1 >> stats.txt
          echo "\`\`\`" >> stats.txt
          echo "" >> stats.txt
          
          echo "## 📄 Список файлов" >> stats.txt
          echo "" >> stats.txt
          echo "### HTML:" >> stats.txt
          find . -name '*.html' | sort >> stats.txt
          echo "" >> stats.txt
          echo "### CSS:" >> stats.txt
          find ./css -name '*.css' | sort >> stats.txt
          echo "" >> stats.txt
          echo "### JavaScript:" >> stats.txt
          find ./js -name '*.js' | sort >> stats.txt
          
          cat stats.txt
          
      - name: Upload statistics
        uses: actions/upload-artifact@v4
        with:
          name: project-stats
          path: stats.txt
          retention-days: 30

